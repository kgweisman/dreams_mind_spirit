---
title: "Reply to Terhune et al."
subtitle: "Luhrmann, Weisman, et al."
output: 
  html_notebook:
    toc: true
    toc_float: true
    code_folding: hide
---

In Study 1, adults with strong religious commitments and faith practices were interviewed in depth about their spiritual experiences and their understanding of the mind by experienced ethnographers. These interviews yielded one measure of porosity (“Porosity Vignettes”), one measure of absorption (the Absorption scale), and one measure of spiritual experience (“Spiritual Events” scale).

This notebook contains all of the analyses for Study 1 (revised July 2020).

```{r, message = F}
source("../scripts_general/dependencies.R")
source("../scripts_general/custom_funs.R")
source("../scripts_general/var_recode_contrast.R")
source("../scripts_general/data_load.R")
```

```{r}
# get item-level question
d1_byq <- read_csv("./data_byquestion/study1_byquestion.csv")
d3_byq <- read_csv("./data_byquestion/packets123_data_byquestion_long.csv") %>%
  filter(packet == 1)
d4_byq <- read_csv("./data_byquestion/study4_byquestion.csv")
```

```{r}
# dataframe with variable names optimized for stargazer tables
d1_fortab <- d1 %>%
  mutate_at(vars(ends_with("_score"), subject_age), scale) %>%
  mutate(subject_hs = case_when(is.na(subject_hs) ~ NA_character_,
                                grepl("yes", tolower(subject_hs)) ~ "yes",
                                TRUE ~ "no"),
         subject_hs = factor(subject_hs, 
                             levels = c("no", "yes")),
         subject_gender = factor(subject_gender, 
                                 levels = c("Female", "Male"))) %>%
  rename("Spiritual Events" = "spev_score",
         "Spiritual Events, recoded" = "spev_recoded_score",
         "Porosity Vignettes" = "pv_score",
         "Absorption" = "abs_score",
         "Country" = "country",
         "Site" = "site",
         "Religion" = "religion",
         "Gender" = "subject_gender",
         "Age" = "subject_age",
         "Education" = "subject_hs")
```

```{r}
# set contrasts
contrasts(d1_fortab$Country) <- cbind(": Gh." = c(-1, 1, 0, 0, 0),
                                      ": Th." = c(-1, 0, 1, 0, 0),
                                      ": Ch." = c(-1, 0, 0, 1, 0),
                                      ": Va." = c(-1, 0, 0, 0, 1))
contrasts(d1_fortab$Site) <- cbind(": rural" = c(-1, 1))
contrasts(d1_fortab$Religion) <- cbind(": CC" = c(1, -1))
contrasts(d1_fortab$Education) <- cbind(": at least HS" = c(-1, 1))
contrasts(d1_fortab$Gender) <- cbind(": male" = c(-1, 1))
```

```{r}
# dataframe with variable names optimized for stargazer tables
d3_fortab <- d3 %>%
  mutate_at(vars(ends_with("_score"), subject_age), scale) %>%
  mutate(subject_gender = factor(subject_gender, 
                                 levels = c("female", "male"))) %>%
  rename("Spiritual Events" = "spev_score",
         "Daily Spiritual Experiences" = "dse_score",
         "Absorption" = "abs_score",
         "Country" = "country",
         "Gender" = "subject_gender",
         "Age" = "subject_age")
```

```{r}
# set contrasts
contrasts(d3_fortab$Country) <- cbind(": Gh." = c(-1, 1, 0, 0, 0),
                                      ": Th." = c(-1, 0, 1, 0, 0),
                                      ": Ch." = c(-1, 0, 0, 1, 0),
                                      ": Va." = c(-1, 0, 0, 0, 1))
contrasts(d3_fortab$Gender) <- cbind(": male" = c(-1, 1))
```

```{r}
# dataframe with variable names optimized for stargazer tables
d4_fortab <- d4 %>%
  mutate_at(vars(ends_with("_score"), subject_age), scale) %>%
  mutate(subject_gender = factor(subject_gender, 
                                 levels = c("female", "male"))) %>%
  rename("Spiritual Events" = "spev_score",
         "Daily Spiritual Experience" = "dse_score",
         "Porosity Vignettes" = "pv_score",
         "Porosity Scale" = "por_score",
         "Absorption" = "abs_score",
         "Hallucinations" = "hall_score",
         "Paranormal" = "para_score",
         "Need for Cognition" = "cog_score",
         "Sense of Control" = "ctl_score",
         "Country" = "country",
         "Gender" = "subject_gender",
         "Age" = "subject_age")
```

```{r}
# set contrasts
contrasts(d4_fortab$Country) <- cbind(": Gh." = c(-1, 1, 0, 0, 0),
                                      ": Th." = c(-1, 0, 1, 0, 0),
                                      ": Ch." = c(-1, 0, 0, 1, 0),
                                      ": Va." = c(-1, 0, 0, 0, 1))
contrasts(d4_fortab$Gender) <- cbind(": male" = c(-1, 1))
```

# Omitting two presence items

"I can often somehow sense the presence of another person before I actually see or hear her/him."
"At times I somehow feel the presence of someone who is not physically there"

## Study 1

```{r}
d1_abs_omit <- d1_byq %>%
  select(subject_id, country, ends_with("_abs")) %>%
  select(-sensepresence_abs, -invisiblepresence_abs) %>%
  gather(question, response, -subject_id, -country) %>%
  group_by(subject_id, country) %>%
  summarise(Absorption = mean(response, na.rm = T)) %>%
  ungroup() %>%
  group_by(country) %>%
  mutate(Absorption = scale(Absorption)) %>%
  ungroup() %>%
  distinct(subject_id, Absorption) %>%
  right_join(d1_fortab %>% select(-Absorption)) %>%
  filter(subject_id %in% d1_fortab$subject_id)
```

### Table S20. Study 1, Spiritual Events: relationships with Porosity Vignettes and Absorption (sample as fixed effect)

```{r}
r04_spev <- lm(`Spiritual Events` ~ `Porosity Vignettes`,
               data = d1_abs_omit)

r05_spev <- lm(`Spiritual Events` ~ Absorption,
               data = d1_abs_omit)

r06_spev <- lm(`Spiritual Events` ~ `Porosity Vignettes` * Absorption,
               data = d1_abs_omit)

r07_spev <- lm(`Spiritual Events` ~ Country * Site * Religion 
               + `Porosity Vignettes` + Country:`Porosity Vignettes`,
               data = d1_abs_omit)

r08_spev <- lm(`Spiritual Events` ~ Country * Site * Religion 
               + Absorption + Country:Absorption,
               data = d1_abs_omit)

r09_spev <- lm(`Spiritual Events` ~ Country * Site * Religion 
               + `Porosity Vignettes` + Country:`Porosity Vignettes`
               + Absorption + Country:Absorption
               + `Porosity Vignettes`:Absorption 
               + Country:`Porosity Vignettes`:Absorption,
               data = d1_abs_omit)

r10_spev <- lm(`Spiritual Events` ~ Country * Site * Religion 
               + `Porosity Vignettes` + Country:`Porosity Vignettes`
               + Absorption + Country:Absorption
               + `Porosity Vignettes`:Absorption
               + Country:`Porosity Vignettes`:Absorption
               + Gender + Age + Education,
               data = d1_abs_omit)
```

```{r, include = F}
# run manually to check convergence
summary(r04_spev)
summary(r05_spev)
summary(r06_spev)
summary(r07_spev)
summary(r08_spev)
summary(r09_spev)
summary(r10_spev)
```

```{r, results = "hide"}
table_s20 <- stargazer(r04_spev, r05_spev, r06_spev, 
                       r07_spev, r08_spev, r09_spev, r10_spev,
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       order = c("^`Porosity Vignettes`$",
                                 "^Absorption$",
                                 "^`Porosity Vignettes`:Absorption$"),
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T)

cat(sub_interact_fun(table_s20), 
    file = "./stargazer_tables/table_s20.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s20.html")
```

### Table S21. Study 1, Spiritual Events: relationships with Porosity Vignettes and Absorption (sample as random effect)

```{r}
r11_spev <- lmer(`Spiritual Events` ~ 1 
                 + (1 | Country/Site/Religion),
                 control = lmerControl(optimizer = "bobyqa"),
                 data = d1_abs_omit)

r12_spev <- lmer(`Spiritual Events` ~ `Porosity Vignettes` 
                 # + (1 + `Porosity Vignettes` | Country/Site/Religion),
                 + (1 | Country/Site/Religion),
                 control = lmerControl(optimizer = "bobyqa"),
                 data = d1_abs_omit)

r13_spev <- lmer(`Spiritual Events` ~ Absorption
                 # + (1 + Absorption | Country/Site/Religion),
                 + (1 | Country/Site/Religion),
                 control = lmerControl(optimizer = "bobyqa"),
                 data = d1_abs_omit)

r14_spev <- lmer(`Spiritual Events` ~ `Porosity Vignettes` * Absorption 
                 # + (1 + `Porosity Vignettes` * Absorption | Country/Site/Religion),
                 # + (1 + `Porosity Vignettes` + Absorption | Country/Site/Religion),
                 + (1 | Country/Site/Religion),
                 control = lmerControl(optimizer = "bobyqa"),
                 data = d1_abs_omit)

r15_spev <- lmer(`Spiritual Events` ~ `Porosity Vignettes` * Absorption
                 + Gender + Age + Education
                 # + (1 + `Porosity Vignettes` * Absorption | Country/Site/Religion),
                 # + (1 + `Porosity Vignettes` + Absorption | Country/Site/Religion),
                 + (1 | Country/Site/Religion),
                 control = lmerControl(optimizer = "bobyqa"),
                 data = d1_abs_omit)
```

```{r, include = F}
# run manually to check convergence
summary(r11_spev)
summary(r12_spev)
summary(r13_spev)
summary(r14_spev)
summary(r15_spev)
```

```{r, include=F}
table_s21 <- stargazer(#r04_spev, r05_spev, r06_spev, 
  r11_spev, r12_spev, r13_spev, r14_spev, r15_spev,
  type = "html",
  ci = T,
  report = c("vcsp"),
  digits = 2,
  digits.extra = 1000,
  omit.table.layout = "n",
  order = c("^`Porosity Vignettes`$",
            "^Absorption$",
            "^`Porosity Vignettes`:Absorption$"),
  # dep.var.labels.include = F,
  dep.var.caption = "",
  single.row = T)

cat(sub_interact_fun(table_s21), 
    file = "./stargazer_tables/table_s21.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s21.html")
```

```{r}
rsq_table_fun(list(r11_spev, r12_spev, r13_spev, r14_spev, r15_spev))
```


## Study 3

```{r}
d3_abs_omit <- d3_byq %>%
  select(subj, ctry, question, response) %>%
  filter(question %in% c("exwl_01", "exwl_02", "exwl_03", "exwl_04", "exwl_05", "exwl_06",
                         "exwl_07", "exwl_08", "exwl_09", "exwl_10", "exwl_11", "exwl_12",
                         "exwl_13", "exwl_14", "exwl_15", "exwl_16", "exwl_17", "exwl_18",
                         "exwl_19", "exwl_20", "exwl_21", "exwl_22", "exwl_23", "exwl_24",
                         "exwl_25", "exwl_26", "exwl_27", "exwl_28", "exwl_29", "exwl_30",
                         "exwl_31", "exwl_32", "exwl_33", "exwl_34")) %>%
  filter(question != "exwl_14", question != "exwl_31") %>%
  group_by(subj, ctry) %>%
  summarise(Absorption = mean(response, na.rm = T)) %>%
  ungroup() %>%
  group_by(ctry) %>%
  mutate(Absorption = scale(Absorption)) %>%
  ungroup() %>%
  distinct(subj, Absorption) %>%
  rename(subject_id = subj) %>%
  right_join(d3_fortab %>% select(-Absorption)) %>%
  filter(subject_id %in% d3_fortab$subject_id)
```

### Table S32. Study 3, Spiritual Events and Daily Spiritual Experience: relationships with Absorption (sample as fixed effect)

```{r}
r03_spev <- lm(`Spiritual Events` ~ `Absorption`,
               data = d3_abs_omit)

r04_spev <- lm(`Spiritual Events` ~ Country * `Absorption`,
               data = d3_abs_omit)

r05_spev <- lm(`Spiritual Events` ~ Country * `Absorption`
               + Gender + Age,  
               data = d3_abs_omit)
```

```{r, include = F}
# run manually to check convergence
summary(r03_spev)
summary(r04_spev)
summary(r05_spev)
```

```{r}
r03_dse <- lm(`Daily Spiritual Experiences` ~ `Absorption`,
              data = d3_abs_omit)

r04_dse <- lm(`Daily Spiritual Experiences` ~ Country * `Absorption`,
              data = d3_abs_omit)

r05_dse <- lm(`Daily Spiritual Experiences` ~ Country * `Absorption`
              + Gender + Age,  
              data = d3_abs_omit)
```

```{r, include = F}
# run manually to check convergence
summary(r03_dse)
summary(r04_dse)
summary(r05_dse)
```

```{r, results = "hide"}
table_s32 <- stargazer(r03_spev, r04_spev, r05_spev, r03_dse, r04_dse, r05_dse, 
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       order = c("^Absorption$"),
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T)

cat(sub_interact_fun(table_s32), 
    file = "./stargazer_tables/table_s32.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s32.html")
```

### Table S33. Study 3, Spiritual Events and Daily Spiritual Experience: relationships with Absorption (sample as random effect)

```{r}
r06_spev <- lmer(`Spiritual Events` ~ 1 
                 + (1 | Country),
                 control = lmerControl(optimizer = "bobyqa"),
                 data = d3_abs_omit)

r07_spev <- lmer(`Spiritual Events` ~ `Absorption` 
                 # + (1 + `Absorption` | Country), # perfectly correlated ranfx
                 + (1 | Country),
                 control = lmerControl(optimizer = "bobyqa"),
                 data = d3_abs_omit)

r08_spev <- lmer(`Spiritual Events` ~ `Absorption`
                 + Gender + Age 
                 # + (1 + `Absorption` + Gender + Age | Country), # perfectly correlated ranfx
                 # + (1 + `Absorption` | Country), # perfectly correlated ranfx
                 + (1 | Country),
                 control = lmerControl(optimizer = "bobyqa"),
                 data = d3_abs_omit)
```

```{r, include = F}
# run manually to check convergence
summary(r06_spev)
summary(r07_spev)
summary(r08_spev)
```

```{r}
r06_dse <- lmer(`Daily Spiritual Experiences` ~ 1 
                + (1 | Country),
                control = lmerControl(optimizer = "bobyqa"),
                data = d3_abs_omit)

r07_dse <- lmer(`Daily Spiritual Experiences` ~ `Absorption` 
                # + (1 + `Absorption` | Country), # perfectly correlated ranfx
                + (1 | Country),
                control = lmerControl(optimizer = "bobyqa"),
                data = d3_abs_omit)

r08_dse <- lmer(`Daily Spiritual Experiences` ~ `Absorption`
                + Gender + Age 
                # + (1 + `Absorption` + Gender + Age | Country), 
                # + (1 + `Absorption` | Country),
                + (1 | Country), # use this for comparsion with spev
                control = lmerControl(optimizer = "bobyqa"),
                data = d3_abs_omit)
```

```{r, include = F}
# run manually to check convergence
summary(r06_dse)
summary(r07_dse)
summary(r08_dse)
```

```{r, results = "hide"}
table_s33 <- stargazer(r06_spev, r07_spev, r08_spev, r06_dse, r07_dse, r08_dse,
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 0800,
                       omit.table.layout = "n",
                       order = c("^`Absorption`$"),
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T)

cat(sub_interact_fun(table_s33), 
    file = "./stargazer_tables/table_s33.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s33.html")
```

```{r}
rsq_table_fun(list(r06_spev, r07_spev, r08_spev, r06_dse, r07_dse, r08_dse))
```

### Table S34. Study 3, Spiritual Events: relationships with Absorption by country

```{r}
r09_us_spev <- lm(`Spiritual Events` ~ `Absorption`,
                  data = d3_abs_omit %>% 
                    filter(Country == "US") %>%
                    mutate_at(vars(`Spiritual Events`, `Absorption`),
                              ~ scale(.)))

r09_gh_spev <- lm(`Spiritual Events` ~ `Absorption`,
                  data = d3_abs_omit %>% 
                    filter(Country == "Ghana") %>%
                    mutate_at(vars(`Spiritual Events`, `Absorption`),
                              ~ scale(.)))

r09_th_spev <- lm(`Spiritual Events` ~ `Absorption`,
                  data = d3_abs_omit %>% 
                    filter(Country == "Thailand") %>%
                    mutate_at(vars(`Spiritual Events`, `Absorption`),
                              ~ scale(.)))

r09_ch_spev <- lm(`Spiritual Events` ~ `Absorption`,
                  data = d3_abs_omit %>% 
                    filter(Country == "China") %>%
                    mutate_at(vars(`Spiritual Events`, `Absorption`),
                              ~ scale(.)))

r09_vt_spev <- lm(`Spiritual Events` ~ `Absorption`,
                  data = d3_abs_omit %>% 
                    filter(Country == "Vanuatu") %>%
                    mutate_at(vars(`Spiritual Events`, `Absorption`),
                              ~ scale(.)))
```

```{r, include = F}
# run manually to check convergence
summary(r09_us_spev)
summary(r09_gh_spev)
summary(r09_th_spev)
summary(r09_ch_spev)
summary(r09_vt_spev)
```

```{r, results = "hide"}
table_s34 <- stargazer(r09_us_spev, r09_gh_spev, r09_th_spev, r09_ch_spev, r09_vt_spev, 
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       order = c("^`Absorption`$"),
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T)

cat(sub_interact_fun(table_s34), 
    file = "./stargazer_tables/table_s34.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s34.html")
```

### Table S35. Study 3, Daily Spiritual Experience: relationships with Absorption by country

```{r}
r09_us_dse <- lm(`Daily Spiritual Experiences` ~ `Absorption`,
                 data = d3_abs_omit %>% 
                   filter(Country == "US") %>%
                   mutate_at(vars(`Daily Spiritual Experiences`, `Absorption`),
                             ~ scale(.)))

r09_gh_dse <- lm(`Daily Spiritual Experiences` ~ `Absorption`,
                 data = d3_abs_omit %>% 
                   filter(Country == "Ghana") %>%
                   mutate_at(vars(`Daily Spiritual Experiences`, `Absorption`),
                             ~ scale(.)))

r09_th_dse <- lm(`Daily Spiritual Experiences` ~ `Absorption`,
                 data = d3_abs_omit %>% 
                   filter(Country == "Thailand") %>%
                   mutate_at(vars(`Daily Spiritual Experiences`, `Absorption`),
                             ~ scale(.)))

r09_ch_dse <- lm(`Daily Spiritual Experiences` ~ `Absorption`,
                 data = d3_abs_omit %>% 
                   filter(Country == "China") %>%
                   mutate_at(vars(`Daily Spiritual Experiences`, `Absorption`),
                             ~ scale(.)))

r09_vt_dse <- lm(`Daily Spiritual Experiences` ~ `Absorption`,
                 data = d3_abs_omit %>% 
                   filter(Country == "Vanuatu") %>%
                   mutate_at(vars(`Daily Spiritual Experiences`, `Absorption`),
                             ~ scale(.)))
```

```{r, include = F}
# run manually to check convergence
summary(r09_us_dse)
summary(r09_gh_dse)
summary(r09_th_dse)
summary(r09_ch_dse)
summary(r09_vt_dse)
```

```{r, results = "hide"}
table_s35 <- stargazer(r09_us_dse, r09_gh_dse, r09_th_dse, r09_ch_dse, r09_vt_dse, 
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       order = c("^`Absorption`$"),
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T)

cat(sub_interact_fun(table_s35), 
    file = "./stargazer_tables/table_s35.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s35.html")
```

## Study 4

## Relationships: Spiritual presence events

```{r}
d4_abs_omit <- d4_byq %>%
  select(p7_subj, p7_ctry, contains("_abs_")) %>%
  select(-ends_with("cat"), -ends_with("total"), -contains("_check")) %>%
  select(-p7_abs_sense.presc, -p7_abs_not.physical) %>%
  gather(question, response, -p7_subj, -p7_ctry) %>%
  group_by(p7_subj, p7_ctry) %>%
  summarise(Absorption = mean(response, na.rm = T)) %>%
  ungroup() %>%
  group_by(p7_ctry) %>%
  mutate(Absorption = scale(Absorption)) %>%
  ungroup() %>%
  distinct(p7_subj, Absorption) %>%
  rename(subject_id = p7_subj) %>%
  right_join(d4_fortab %>% select(-Absorption)) %>%
  filter(subject_id %in% d4_fortab$subject_id)
```

```{r}
# longform dataframe
d4_fortab_long_spirit <- d4_abs_omit %>% 
  gather(Scale, Score, 
         c(`Spiritual Events`, `Daily Spiritual Experience`)) %>%
  mutate(Scale = factor(Scale))
```

```{r}
# set contrasts
contrasts(d4_fortab_long_spirit$Country) <- cbind(": Gh." = c(-1, 1, 0, 0, 0),
                                                  ": Th." = c(-1, 0, 1, 0, 0),
                                                  ": Ch." = c(-1, 0, 0, 1, 0),
                                                  ": Va." = c(-1, 0, 0, 0, 1))
contrasts(d4_fortab_long_spirit$Gender) <- cbind(": male" = c(-1, 1))
contrasts(d4_fortab_long_spirit$Scale) <- cbind(": Spiritual Events" = c(-1, 1))
```


### Table S40. Study 4, measures of spiritual presence events: relationships with Porosity Vignettes and Absorption (sample as fixed effect)

```{r}
r03_spirit <- lmer(Score ~ Scale * `Porosity Vignettes`
                   + (1 | subject_id),
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)

r04_spirit <- lmer(Score ~ Scale * `Porosity Scale`
                   + (1 | subject_id),
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)

r05_spirit <- lmer(Score ~ Scale * Absorption
                   + (1 | subject_id),
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)

r06_spirit <- lmer(Score ~ Scale * Country * `Porosity Vignettes`
                   + (1 | subject_id),
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)

r07_spirit <- lmer(Score ~ Scale * Country * `Porosity Scale`
                   + (1 | subject_id),
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)

r08_spirit <- lmer(Score ~ Scale * Country * Absorption
                   + (1 | subject_id),
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)

r09_spirit <- lmer(Score ~ Scale * Country * `Porosity Vignettes` * Absorption
                   + (1 | subject_id),
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)

r10_spirit <- lmer(Score ~ Scale * Country * `Porosity Scale` * Absorption
                   + (1 | subject_id),
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)

r11_spirit <- lmer(Score ~ Scale * Country * `Porosity Vignettes` * Absorption
                   + Gender + Age
                   + (1 | subject_id),
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)

r12_spirit <- lmer(Score ~ Scale * Country * `Porosity Scale` * Absorption
                   + Gender + Age
                   + (1 | subject_id),
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)
```

```{r, include = F}
# run manually to check convergence
summary(r03_spirit)
summary(r04_spirit)
summary(r05_spirit)
summary(r06_spirit)
summary(r07_spirit)
summary(r08_spirit)
summary(r09_spirit)
summary(r10_spirit)
summary(r11_spirit)
summary(r12_spirit)
```

```{r, results = "hide"}
table_s40 <- stargazer(r03_spirit, #r04_spirit, 
                       r05_spirit, r06_spirit, #r07_spirit, 
                       r08_spirit, r09_spirit, #r10_spirit,
                       r11_spirit, #r12_spirit, 
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       order = c("^`Porosity Vignettes`$",
                                 "^Absorption$",
                                 "^`Porosity Vignettes`:Absorption$"),
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T) 

cat(sub_interact_fun(table_s40), 
    file = "./stargazer_tables/table_s40.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s40.html")
```

```{r}
rsq_table_fun(list(r03_spirit, #r04_spirit, 
                   r05_spirit, r06_spirit, #r07_spirit, 
                   r08_spirit, r09_spirit, #r10_spirit,
                   r11_spirit #, r12_spirit 
))
```

### Table S41. Study 4, measures of spiritual presence events: relationships with Porosity Scale and Absorption (sample as fixed effect)

```{r, results = "hide"}
table_s41 <- stargazer(#r03_spirit, 
  r04_spirit, r05_spirit, #r06_spirit,
  r07_spirit, r08_spirit, #r09_spirit, 
  r10_spirit, #r11_spirit, 
  r12_spirit, 
  type = "html",
  ci = T,
  report = c("vcsp"),
  digits = 2,
  digits.extra = 1000,
  omit.table.layout = "n",
  order = c("^`Porosity Scale`$",
            "^Absorption$",
            "^`Porosity Scale`:Absorption$"),
  # dep.var.labels.include = F,
  dep.var.caption = "",
  single.row = T) 

cat(sub_interact_fun(table_s41), 
    file = "./stargazer_tables/table_s41.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s41.html")
```

```{r}
rsq_table_fun(list(#r03_spirit, 
  r04_spirit, r05_spirit, #r06_spirit,
  r07_spirit, r08_spirit, #r09_spirit, 
  r10_spirit, #r11_spirit, 
  r12_spirit))
```

### Table S42. Study 4, measures of spiritual presence events: relationships with Porosity Vignettes and Absorption (sample as random effect)

```{r}
r13_spirit <- lmer(Score ~ Scale
                   + (1 | Country/subject_id),
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)

r14_spirit <- lmer(Score ~ Scale * `Porosity Vignettes`
                   + (1 | Country/subject_id),
                   # + (1 + `Porosity Vignettes` | Country), # adding to above, failed to converge
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)

r15_spirit <- lmer(Score ~ Scale * `Porosity Scale`
                   + (1 | Country/subject_id),
                   # + (1 + `Porosity Scale` | Country), # adding to above, perfectly correlated ranfx
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)

r16_spirit <- lmer(Score ~ Scale * Absorption
                   + (1 | Country/subject_id),
                   # + (1 + Absorption | Country), # adding to above, perfectly correlated ranfx
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)

r17_spirit <- lmer(Score ~ Scale * `Porosity Vignettes` * Absorption
                   + (1 | Country/subject_id),
                   # + (1 + `Porosity Vignettes` * Absorption | Country), # adding to above, perfectly correlated ranfx
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)

r18_spirit <- lmer(Score ~ Scale * `Porosity Scale` * Absorption
                   + (1 | Country/subject_id), 
                   # + (1 + `Porosity Scale` * Absorption | Country), # adding to above, perfectly correlated ranfx
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)

r19_spirit <- lmer(Score ~ Scale * `Porosity Vignettes` * Absorption
                   + Gender + Age
                   + (1 | Country/subject_id),
                   # + (1 + `Porosity Vignettes` * Absorption + Gender + Age | Country),
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)

r20_spirit <- lmer(Score ~ Scale * `Porosity Scale` * Absorption
                   + Gender + Age
                   + (1 | Country/subject_id),
                   # + (1 + `Porosity Scale` * Absorption + Gender + Age | Country),
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)
```

```{r, include = F}
# run manually to check convergence
summary(r13_spirit)
summary(r14_spirit)
summary(r15_spirit)
summary(r16_spirit)
summary(r17_spirit)
summary(r18_spirit)
summary(r19_spirit)
summary(r20_spirit)
```

```{r, results = "hide"}
table_s42 <- stargazer(r13_spirit, r14_spirit, #r15_spirit,
                       r16_spirit, r17_spirit, #r18_spirit,
                       r19_spirit, #r20_spirit,
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       order = c("^`Porosity Vignettes`$",
                                 "^Absorption$",
                                 "^`Porosity Vignettes`:Absorption$"),
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T)

cat(sub_interact_fun(table_s42), 
    file = "./stargazer_tables/table_s42.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s42.html")
```

```{r}
rsq_table_fun(list(r13_spirit, r14_spirit, #r15_spirit,
                   r16_spirit, r17_spirit, #r18_spirit,
                   r19_spirit #, r20_spirit
))
```

### Table S43. Study 4, measures of spiritual presence events: relationships with Porosity Scale and Absorption (sample as random effect)

```{r, results = "hide"}
table_s43 <- stargazer(r13_spirit, #r14_spirit, 
                       r15_spirit, r16_spirit, #r17_spirit, 
                       r18_spirit, #r19_spirit, 
                       r20_spirit,
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       order = c("^`Porosity Scale`$",
                                 "^Absorption$",
                                 "^`Porosity Scale`:Absorption$"),
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T)

cat(sub_interact_fun(table_s43), 
    file = "./stargazer_tables/table_s43.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s43.html")
```

```{r}
rsq_table_fun(list(r13_spirit, #r14_spirit, 
                   r15_spirit, r16_spirit, #r17_spirit, 
                   r18_spirit, #r19_spirit 
                   r20_spirit
))
```

### Table S44. Study 4, measures of spiritual presence events: relationships with Porosity Vignettes by country

```{r}
r21_spirit_us <- lmer(Score ~ Scale * `Porosity Vignettes` 
                      + (1 | subject_id),
                      control = lmerControl(optimizer = "bobyqa"),
                      data = d4_fortab_long_spirit %>% filter(Country == "US") %>%
                        mutate_at(vars(Score, `Porosity Vignettes`), ~ scale(.)))

r21_spirit_gh <- lmer(Score ~ Scale * `Porosity Vignettes` 
                      + (1 | subject_id),
                      control = lmerControl(optimizer = "bobyqa"),
                      data = d4_fortab_long_spirit %>% filter(Country == "Ghana") %>%
                        mutate_at(vars(Score, ,`Porosity Vignettes`), ~ scale(.)))

r21_spirit_th <- lmer(Score ~ Scale * `Porosity Vignettes` 
                      + (1 | subject_id),
                      control = lmerControl(optimizer = "bobyqa"),
                      data = d4_fortab_long_spirit %>% filter(Country == "Thailand") %>%
                        mutate_at(vars(Score, `Porosity Vignettes`), ~ scale(.)))

r21_spirit_ch <- lmer(Score ~ Scale * `Porosity Vignettes` 
                      + (1 | subject_id),
                      control = lmerControl(optimizer = "bobyqa"),
                      data = d4_fortab_long_spirit %>% filter(Country == "China") %>%
                        mutate_at(vars(Score, `Porosity Vignettes`), ~ scale(.)))

r21_spirit_vt <- lmer(Score ~ Scale * `Porosity Vignettes` 
                      + (1 | subject_id),
                      control = lmerControl(optimizer = "bobyqa"),
                      data = d4_fortab_long_spirit %>% filter(Country == "Vanuatu") %>%
                        mutate_at(vars(Score, `Porosity Vignettes`), ~ scale(.)))
```

```{r, include = F}
# run manually to check convergence
summary(r21_spirit_us)
summary(r21_spirit_gh)
summary(r21_spirit_th)
summary(r21_spirit_ch)
summary(r21_spirit_vt)
```

```{r, results = "hide"}
table_s44 <- stargazer(r21_spirit_us, r21_spirit_gh, r21_spirit_th, 
                       r21_spirit_ch, r21_spirit_vt, 
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       order = c("^`Porosity Vignettes`$"),
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T)

cat(sub_interact_fun(table_s44), 
    file = "./stargazer_tables/table_s44.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s44.html")
```

```{r}
rsq_table_fun(list(r21_spirit_us, r21_spirit_gh, r21_spirit_th, 
                   r21_spirit_ch, r21_spirit_vt))
```

### Table S45. Study 4, measures of spiritual presence events: relationships with Porosity Scale by country

```{r}
r22_spirit_us <- lmer(Score ~ Scale * `Porosity Scale` 
                      + (1 | subject_id),
                      control = lmerControl(optimizer = "bobyqa"),
                      data = d4_fortab_long_spirit %>% filter(Country == "US") %>%
                        mutate_at(vars(Score, `Porosity Scale`), ~ scale(.)))

r22_spirit_gh <- lmer(Score ~ Scale * `Porosity Scale` 
                      + (1 | subject_id),
                      control = lmerControl(optimizer = "bobyqa"),
                      data = d4_fortab_long_spirit %>% filter(Country == "Ghana") %>%
                        mutate_at(vars(Score, `Porosity Scale`), ~ scale(.)))

r22_spirit_th <- lmer(Score ~ Scale * `Porosity Scale` 
                      + (1 | subject_id),
                      control = lmerControl(optimizer = "bobyqa"),
                      data = d4_fortab_long_spirit %>% filter(Country == "Thailand") %>%
                        mutate_at(vars(Score, `Porosity Scale`), ~ scale(.)))

r22_spirit_ch <- lmer(Score ~ Scale * `Porosity Scale` 
                      + (1 | subject_id),
                      control = lmerControl(optimizer = "bobyqa"),
                      data = d4_fortab_long_spirit %>% filter(Country == "China") %>%
                        mutate_at(vars(Score, `Porosity Scale`), ~ scale(.)))

r22_spirit_vt <- lmer(Score ~ Scale * `Porosity Scale` 
                      + (1 | subject_id),
                      control = lmerControl(optimizer = "bobyqa"),
                      data = d4_fortab_long_spirit %>% filter(Country == "Vanuatu") %>%
                        mutate_at(vars(Score, `Porosity Scale`), ~ scale(.)))
```

```{r, include = F}
# run manually to check convergence
summary(r22_spirit_us)
summary(r22_spirit_gh)
summary(r22_spirit_th)
summary(r22_spirit_ch)
summary(r22_spirit_vt)
```

```{r, results = "hide"}
table_s45 <- stargazer(r22_spirit_us, r22_spirit_gh, r22_spirit_th, 
                       r22_spirit_ch, r22_spirit_vt, 
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       order = c("^`Porosity Scale`$"),
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T)

cat(sub_interact_fun(table_s45), 
    file = "./stargazer_tables/table_s45.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s45.html")
```

```{r}
rsq_table_fun(list(r22_spirit_us, r22_spirit_gh, r22_spirit_th, 
                   r22_spirit_ch, r22_spirit_vt))
```

### Table S46. Study 4, measures of spiritual presence events: relationships with Absorption by country

```{r}
r23_spirit_us <- lmer(Score ~ Scale * `Absorption` 
                      + (1 | subject_id),
                      control = lmerControl(optimizer = "bobyqa"),
                      data = d4_fortab_long_spirit %>% filter(Country == "US") %>%
                        mutate_at(vars(Score, `Absorption`), ~ scale(.)))

r23_spirit_gh <- lmer(Score ~ Scale * `Absorption` 
                      + (1 | subject_id),
                      control = lmerControl(optimizer = "bobyqa"),
                      data = d4_fortab_long_spirit %>% filter(Country == "Ghana") %>%
                        mutate_at(vars(Score, `Absorption`), ~ scale(.)))

r23_spirit_th <- lmer(Score ~ Scale * `Absorption` 
                      + (1 | subject_id),
                      control = lmerControl(optimizer = "bobyqa"),
                      data = d4_fortab_long_spirit %>% filter(Country == "Thailand") %>%
                        mutate_at(vars(Score, `Absorption`), ~ scale(.)))

r23_spirit_ch <- lmer(Score ~ Scale * `Absorption` 
                      + (1 | subject_id),
                      control = lmerControl(optimizer = "bobyqa"),
                      data = d4_fortab_long_spirit %>% filter(Country == "China") %>%
                        mutate_at(vars(Score, `Absorption`), ~ scale(.)))

r23_spirit_vt <- lmer(Score ~ Scale * `Absorption` 
                      + (1 | subject_id),
                      control = lmerControl(optimizer = "bobyqa"),
                      data = d4_fortab_long_spirit %>% filter(Country == "Vanuatu") %>%
                        mutate_at(vars(Score, `Absorption`), ~ scale(.)))
```

```{r, include = F}
# run manually to check convergence
summary(r23_spirit_us)
summary(r23_spirit_gh)
summary(r23_spirit_th)
summary(r23_spirit_ch)
summary(r23_spirit_vt)
```

```{r, results = "hide"}
table_s46 <- stargazer(r23_spirit_us, r23_spirit_gh, r23_spirit_th, 
                       r23_spirit_ch, r23_spirit_vt, 
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       order = c("^Absorption$"),
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T)

cat(sub_interact_fun(table_s46), 
    file = "./stargazer_tables/table_s46.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s46.html")
```

```{r}
rsq_table_fun(list(r23_spirit_us, r23_spirit_gh, r23_spirit_th, 
                   r23_spirit_ch, r23_spirit_vt))
```

## Relationships: Secular anomalous events

### Setup

```{r}
# longform dataframe
d4_fortab_long_secular <- d4_abs_omit %>% 
  gather(Scale, Score, 
         c(Hallucinations, Paranormal)) %>%
  mutate(Scale = factor(Scale))
```

```{r}
# set contrasts
contrasts(d4_fortab_long_secular$Country) <- cbind(": Gh." = c(-1, 1, 0, 0, 0),
                                                   ": Th." = c(-1, 0, 1, 0, 0),
                                                   ": Ch." = c(-1, 0, 0, 1, 0),
                                                   ": Va." = c(-1, 0, 0, 0, 1))
contrasts(d4_fortab_long_secular$Gender) <- cbind(": male" = c(-1, 1))
contrasts(d4_fortab_long_secular$Scale) <- cbind(": Hallucinations" = c(1, -1))
```


### Table S47. Study 4, measures of secular anomalous events: relationships with Porosity Vignettes and Absorption (sample as fixed effect)

```{r}
r03_secular <- lmer(Score ~ Scale * `Porosity Vignettes`
                    + (1 | subject_id),
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)

r04_secular <- lmer(Score ~ Scale * `Porosity Scale`
                    + (1 | subject_id),
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)

r05_secular <- lmer(Score ~ Scale * Absorption
                    + (1 | subject_id),
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)

r06_secular <- lmer(Score ~ Scale * Country * `Porosity Vignettes`
                    + (1 | subject_id),
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)

r07_secular <- lmer(Score ~ Scale * Country * `Porosity Scale`
                    + (1 | subject_id),
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)

r08_secular <- lmer(Score ~ Scale * Country * Absorption
                    + (1 | subject_id),
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)

r09_secular <- lmer(Score ~ Scale * Country * `Porosity Vignettes` * Absorption
                    + (1 | subject_id),
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)

r10_secular <- lmer(Score ~ Scale * Country * `Porosity Scale` * Absorption
                    + (1 | subject_id),
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)

r11_secular <- lmer(Score ~ Scale * Country * `Porosity Vignettes` * Absorption
                    + Gender + Age
                    + (1 | subject_id),
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)

r12_secular <- lmer(Score ~ Scale * Country * `Porosity Scale` * Absorption
                    + Gender + Age
                    + (1 | subject_id),
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)
```

```{r, include = F}
# run manually to check convergence
summary(r03_secular)
summary(r04_secular)
summary(r05_secular)
summary(r06_secular)
summary(r07_secular)
summary(r08_secular)
summary(r09_secular)
summary(r10_secular)
summary(r11_secular)
summary(r12_secular)
```

```{r, results = "hide"}
table_s47 <- stargazer(r03_secular, #r04_secular, 
                       r05_secular, r06_secular, #r07_secular, 
                       r08_secular, r09_secular, #r10_secular,
                       r11_secular, #r12_secular, 
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       order = c("^`Porosity Vignettes`$",
                                 "^Absorption$",
                                 "^`Porosity Vignettes`:Absorption$"),
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T) 

cat(sub_interact_fun(table_s47), 
    file = "./stargazer_tables/table_s47.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s47.html")
```

```{r}
rsq_table_fun(list(r03_secular, #r04_secular, 
                   r05_secular, r06_secular, #r07_secular, 
                   r08_secular, r09_secular, #r10_secular,
                   r11_secular #, r12_secular 
))
```

### Table S48. Study 4, measures of secular anomalous events: relationships with Porosity Scale and Absorption (sample as fixed effect)

```{r, results = "hide"}
table_s48 <- stargazer(#r03_secular, 
  r04_secular, r05_secular, #r06_secular,
  r07_secular, r08_secular, #r09_secular, 
  r10_secular, #r11_secular, 
  r12_secular, 
  type = "html",
  ci = T,
  report = c("vcsp"),
  digits = 2,
  digits.extra = 1000,
  omit.table.layout = "n",
  order = c("^`Porosity Scale`$",
            "^Absorption$",
            "^`Porosity Scale`:Absorption$"),
  # dep.var.labels.include = F,
  dep.var.caption = "",
  single.row = T) 

cat(sub_interact_fun(table_s48), 
    file = "./stargazer_tables/table_s48.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s48.html")
```

```{r}
rsq_table_fun(list(#r03_secular, 
  r04_secular, r05_secular, #r06_secular,
  r07_secular, r08_secular, #r09_secular, 
  r10_secular, #r11_secular, 
  r12_secular))
```

### Table S49. Study 4, measures of secular anomalous events: relationships with Porosity Vignettes and Absorption (sample as random effect)

```{r}
r13_secular <- lmer(Score ~ Scale
                    + (1 | Country/subject_id),
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)

r14_secular <- lmer(Score ~ Scale * `Porosity Vignettes`
                    + (1 | Country/subject_id),
                    # + (1 + `Porosity Vignettes` | Country), # adding to above, failed to converge
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)

r15_secular <- lmer(Score ~ Scale * `Porosity Scale`
                    + (1 | Country/subject_id),
                    # + (1 + `Porosity Scale` | Country), # adding to above, perfectly correlated ranfx
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)

r16_secular <- lmer(Score ~ Scale * Absorption
                    + (1 | Country/subject_id),
                    # + (1 + Absorption | Country), # adding to above, perfectly correlated ranfx
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)

r17_secular <- lmer(Score ~ Scale * `Porosity Vignettes` * Absorption
                    + (1 | Country/subject_id),
                    # + (1 + `Porosity Vignettes` * Absorption | Country), # adding to above, perfectly correlated ranfx
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)

r18_secular <- lmer(Score ~ Scale * `Porosity Scale` * Absorption
                    + (1 | Country/subject_id), 
                    # + (1 + `Porosity Scale` * Absorption | Country), # adding to above, perfectly correlated ranfx
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)

r19_secular <- lmer(Score ~ Scale * `Porosity Vignettes` * Absorption
                    + Gender + Age
                    + (1 | Country/subject_id),
                    # + (1 + `Porosity Vignettes` * Absorption + Gender + Age | Country),
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)

r20_secular <- lmer(Score ~ Scale * `Porosity Scale` * Absorption
                    + Gender + Age
                    + (1 | Country/subject_id),
                    # + (1 + `Porosity Scale` * Absorption + Gender + Age | Country),
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)
```

```{r, include = F}
# run manually to check convergence
summary(r13_secular)
summary(r14_secular)
summary(r15_secular)
summary(r16_secular)
summary(r17_secular)
summary(r18_secular)
summary(r19_secular)
summary(r20_secular)
```

```{r, results = "hide"}
table_s49 <- stargazer(r13_secular, r14_secular, #r15_secular,
                       r16_secular, r17_secular, #r18_secular,
                       r19_secular, #r20_secular,
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       order = c("^`Porosity Vignettes`$",
                                 "^Absorption$",
                                 "^`Porosity Vignettes`:Absorption$"),
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T)

cat(sub_interact_fun(table_s49), 
    file = "./stargazer_tables/table_s49.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s49.html")
```

```{r}
rsq_table_fun(list(r13_secular, r14_secular, #r15_secular,
                   r16_secular, r17_secular, #r18_secular,
                   r19_secular #, r20_secular
))
```

### Table S50. Study 4, measures of secular anomalous events: relationships with Porosity Scale and Absorption (sample as random effect)

```{r, results = "hide"}
table_s50 <- stargazer(r13_secular, #r14_secular, 
                       r15_secular, r16_secular, #r17_secular, 
                       r18_secular, #r19_secular, 
                       r20_secular,
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       order = c("^`Porosity Scale`$",
                                 "^Absorption$",
                                 "^`Porosity Scale`:Absorption$"),
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T)

cat(sub_interact_fun(table_s50), 
    file = "./stargazer_tables/table_s50.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s50.html")
```

```{r}
rsq_table_fun(list(r13_secular, #r14_secular, 
                   r15_secular, r16_secular, #r17_secular, 
                   r18_secular, #r19_secular 
                   r20_secular
))
```

### Table S51. Study 4, measures of secular anomalous events: relationships with Porosity Vignettes by country

```{r}
r21_secular_us <- lmer(Score ~ Scale * `Porosity Vignettes` 
                       + (1 | subject_id),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_fortab_long_secular %>% filter(Country == "US") %>%
                         mutate_at(vars(Score, `Porosity Vignettes`), ~ scale(.)))

r21_secular_gh <- lmer(Score ~ Scale * `Porosity Vignettes` 
                       + (1 | subject_id),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_fortab_long_secular %>% filter(Country == "Ghana") %>%
                         mutate_at(vars(Score, ,`Porosity Vignettes`), ~ scale(.)))

r21_secular_th <- lmer(Score ~ Scale * `Porosity Vignettes` 
                       + (1 | subject_id),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_fortab_long_secular %>% filter(Country == "Thailand") %>%
                         mutate_at(vars(Score, `Porosity Vignettes`), ~ scale(.)))

r21_secular_ch <- lmer(Score ~ Scale * `Porosity Vignettes` 
                       + (1 | subject_id),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_fortab_long_secular %>% filter(Country == "China") %>%
                         mutate_at(vars(Score, `Porosity Vignettes`), ~ scale(.)))

r21_secular_vt <- lmer(Score ~ Scale * `Porosity Vignettes` 
                       + (1 | subject_id),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_fortab_long_secular %>% filter(Country == "Vanuatu") %>%
                         mutate_at(vars(Score, `Porosity Vignettes`), ~ scale(.)))
```

```{r, include = F}
# run manually to check convergence
summary(r21_secular_us)
summary(r21_secular_gh)
summary(r21_secular_th)
summary(r21_secular_ch)
summary(r21_secular_vt)
```

```{r, results = "hide"}
table_s51 <- stargazer(r21_secular_us, r21_secular_gh, r21_secular_th, 
                       r21_secular_ch, r21_secular_vt, 
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       order = c("^`Porosity Vignettes`$"),
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T)

cat(sub_interact_fun(table_s51), 
    file = "./stargazer_tables/table_s51.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s51.html")
```

```{r}
rsq_table_fun(list(r21_secular_us, r21_secular_gh, r21_secular_th, 
                   r21_secular_ch, r21_secular_vt))
```

### Table S52. Study 4, measures of secular anomalous events: relationships with Porosity Scale by country

```{r}
r22_secular_us <- lmer(Score ~ Scale * `Porosity Scale` 
                       + (1 | subject_id),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_fortab_long_secular %>% filter(Country == "US") %>%
                         mutate_at(vars(Score, `Porosity Scale`), ~ scale(.)))

r22_secular_gh <- lmer(Score ~ Scale * `Porosity Scale` 
                       + (1 | subject_id),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_fortab_long_secular %>% filter(Country == "Ghana") %>%
                         mutate_at(vars(Score, `Porosity Scale`), ~ scale(.)))

r22_secular_th <- lmer(Score ~ Scale * `Porosity Scale` 
                       + (1 | subject_id),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_fortab_long_secular %>% filter(Country == "Thailand") %>%
                         mutate_at(vars(Score, `Porosity Scale`), ~ scale(.)))

r22_secular_ch <- lmer(Score ~ Scale * `Porosity Scale` 
                       + (1 | subject_id),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_fortab_long_secular %>% filter(Country == "China") %>%
                         mutate_at(vars(Score, `Porosity Scale`), ~ scale(.)))

r22_secular_vt <- lmer(Score ~ Scale * `Porosity Scale` 
                       + (1 | subject_id),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_fortab_long_secular %>% filter(Country == "Vanuatu") %>%
                         mutate_at(vars(Score, `Porosity Scale`), ~ scale(.)))
```

```{r, include = F}
# run manually to check convergence
summary(r22_secular_us)
summary(r22_secular_gh)
summary(r22_secular_th)
summary(r22_secular_ch)
summary(r22_secular_vt)
```

```{r, results = "hide"}
table_s52 <- stargazer(r22_secular_us, r22_secular_gh, r22_secular_th, 
                       r22_secular_ch, r22_secular_vt, 
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       order = c("^`Porosity Scale`$"),
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T)

cat(sub_interact_fun(table_s52), 
    file = "./stargazer_tables/table_s52.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s52.html")
```

```{r}
rsq_table_fun(list(r22_secular_us, r22_secular_gh, r22_secular_th, 
                   r22_secular_ch, r22_secular_vt))
```

### Table S53. Study 4, measures of secular anomalous events: relationships with Absorption by country

```{r}
r23_secular_us <- lmer(Score ~ Scale * `Absorption` 
                       + (1 | subject_id),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_fortab_long_secular %>% filter(Country == "US") %>%
                         mutate_at(vars(Score, `Absorption`), ~ scale(.)))

r23_secular_gh <- lmer(Score ~ Scale * `Absorption` 
                       + (1 | subject_id),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_fortab_long_secular %>% filter(Country == "Ghana") %>%
                         mutate_at(vars(Score, `Absorption`), ~ scale(.)))

r23_secular_th <- lmer(Score ~ Scale * `Absorption` 
                       + (1 | subject_id),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_fortab_long_secular %>% filter(Country == "Thailand") %>%
                         mutate_at(vars(Score, `Absorption`), ~ scale(.)))

r23_secular_ch <- lmer(Score ~ Scale * `Absorption` 
                       + (1 | subject_id),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_fortab_long_secular %>% filter(Country == "China") %>%
                         mutate_at(vars(Score, `Absorption`), ~ scale(.)))

r23_secular_vt <- lmer(Score ~ Scale * `Absorption` 
                       + (1 | subject_id),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_fortab_long_secular %>% filter(Country == "Vanuatu") %>%
                         mutate_at(vars(Score, `Absorption`), ~ scale(.)))
```

```{r, include = F}
# run manually to check convergence
summary(r23_secular_us)
summary(r23_secular_gh)
summary(r23_secular_th)
summary(r23_secular_ch)
summary(r23_secular_vt)
```

```{r, results = "hide"}
table_s53 <- stargazer(r23_secular_us, r23_secular_gh, r23_secular_th, 
                       r23_secular_ch, r23_secular_vt, 
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       order = c("^Absorption$"),
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T)

cat(sub_interact_fun(table_s53), 
    file = "./stargazer_tables/table_s53.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s53.html")
```

```{r}
rsq_table_fun(list(r23_secular_us, r23_secular_gh, r23_secular_th, 
                   r23_secular_ch, r23_secular_vt))
```


# Exploratory factor analyses

## Study 1

### All sites

```{r}
d1_abs <- d1_byq %>%
  select(subject_id, ends_with("_abs")) %>%
  column_to_rownames("subject_id")
```

```{r}
fa.parallel(d1_abs)
```

```{r}
d1_all_efa <- fa(d1_abs, nfactors = 4, rotate = "oblimin")
```

```{r}
d1_all_loadings <- d1_all_efa$loadings[] %>% 
  fa.sort() %>%
  data.frame() %>%
  rownames_to_column("question") %>%
  mutate(order = 1:nrow(.)) %>%
  gather(factor, loading, -question, -order)
```

```{r, fig.width = 3, fig.asp = 1}
d1_all_loadings %>%
  mutate(question = gsub("_abs", "", question)) %>%
  ggplot(aes(x = factor, y = reorder(question, desc(order)), fill = loading)) +
  geom_tile(color = "black") +
  geom_text(aes(label = format(round(loading, 2), nsmall = 2)), size = 3) +
  scale_fill_distiller(palette = "RdYlBu", limits = c(-1, 1)) +
  labs(title = "Study 1: All sites", x = "factor", y = "question")
```

### US

```{r}
d1_abs_us <- d1_byq %>%
  filter(country == "US") %>%
  select(subject_id, ends_with("_abs")) %>%
  column_to_rownames("subject_id")
```

```{r}
fa.parallel(d1_abs_us)
```

```{r}
d1_us_efa <- fa(d1_abs, nfactors = 3, rotate = "oblimin")
```

```{r}
d1_us_loadings <- d1_us_efa$loadings[] %>% 
  fa.sort() %>%
  data.frame() %>%
  rownames_to_column("question") %>%
  mutate(order = 1:nrow(.)) %>%
  gather(factor, loading, -question, -order)
```

```{r, fig.width = 3, fig.asp = 1}
d1_us_loadings %>%
  mutate(question = gsub("_abs", "", question)) %>%
  ggplot(aes(x = factor, y = reorder(question, desc(order)), fill = loading)) +
  geom_tile(color = "black") +
  geom_text(aes(label = format(round(loading, 2), nsmall = 2)), size = 3) +
  scale_fill_distiller(palette = "RdYlBu", limits = c(-1, 1)) +
  labs(title = "Study 1: US", x = "factor", y = "question")
```

### Ghana

```{r}
d1_abs_gh <- d1_byq %>%
  filter(country == "Ghana") %>%
  select(subject_id, ends_with("_abs")) %>%
  column_to_rownames("subject_id")
```

```{r}
fa.parallel(d1_abs_gh)
```

```{r}
d1_gh_efa <- fa(d1_abs, nfactors = 2, rotate = "oblimin")
```

```{r}
d1_gh_loadings <- d1_gh_efa$loadings[] %>% 
  fa.sort() %>%
  data.frame() %>%
  rownames_to_column("question") %>%
  mutate(order = 1:nrow(.)) %>%
  gather(factor, loading, -question, -order)
```

```{r, fig.width = 3, fig.asp = 1}
d1_gh_loadings %>%
  mutate(question = gsub("_abs", "", question)) %>%
  ggplot(aes(x = factor, y = reorder(question, desc(order)), fill = loading)) +
  geom_tile(color = "black") +
  geom_text(aes(label = format(round(loading, 2), nsmall = 2)), size = 3) +
  scale_fill_distiller(palette = "RdYlBu", limits = c(-1, 1)) +
  labs(title = "Study 1: Ghana", x = "factor", y = "question")
```

### Thailand

```{r}
d1_abs_th <- d1_byq %>%
  filter(country == "Thailand") %>%
  select(subject_id, ends_with("_abs")) %>%
  column_to_rownames("subject_id")
```

```{r}
fa.parallel(d1_abs_th)
```

```{r}
d1_th_efa <- fa(d1_abs, nfactors = 1, rotate = "oblimin")
```

```{r}
d1_th_loadings <- d1_th_efa$loadings[] %>% 
  fa.sort() %>%
  data.frame() %>%
  rownames_to_column("question") %>%
  mutate(order = 1:nrow(.)) %>%
  gather(factor, loading, -question, -order)
```

```{r, fig.width = 3, fig.asp = 1}
d1_th_loadings %>%
  mutate(question = gsub("_abs", "", question)) %>%
  ggplot(aes(x = factor, y = reorder(question, desc(order)), fill = loading)) +
  geom_tile(color = "black") +
  geom_text(aes(label = format(round(loading, 2), nsmall = 2)), size = 3) +
  scale_fill_distiller(palette = "RdYlBu", limits = c(-1, 1)) +
  labs(title = "Study 1: Thailand", x = "factor", y = "question")
```

### China

```{r}
d1_abs_ch <- d1_byq %>%
  filter(country == "China") %>%
  select(subject_id, ends_with("_abs")) %>%
  column_to_rownames("subject_id")
```

```{r}
fa.parallel(d1_abs_ch)
```

```{r}
d1_ch_efa <- fa(d1_abs, nfactors = 1, rotate = "oblimin")
```

```{r}
d1_ch_loadings <- d1_ch_efa$loadings[] %>% 
  fa.sort() %>%
  data.frame() %>%
  rownames_to_column("question") %>%
  mutate(order = 1:nrow(.)) %>%
  gather(factor, loading, -question, -order)
```

```{r, fig.width = 3, fig.asp = 1}
d1_ch_loadings %>%
  mutate(question = gsub("_abs", "", question)) %>%
  ggplot(aes(x = factor, y = reorder(question, desc(order)), fill = loading)) +
  geom_tile(color = "black") +
  geom_text(aes(label = format(round(loading, 2), nsmall = 2)), size = 3) +
  scale_fill_distiller(palette = "RdYlBu", limits = c(-1, 1)) +
  labs(title = "Study 1: China", x = "factor", y = "question")
```

### Vanuatu

```{r}
d1_abs_vt <- d1_byq %>%
  filter(country == "Vanuatu") %>%
  select(subject_id, ends_with("_abs")) %>%
  column_to_rownames("subject_id")
```

```{r}
fa.parallel(d1_abs_vt)
```

```{r}
d1_vt_efa <- fa(d1_abs, nfactors = 5, rotate = "oblimin")
```

```{r}
d1_vt_loadings <- d1_vt_efa$loadings[] %>% 
  fa.sort() %>%
  data.frame() %>%
  rownames_to_column("question") %>%
  mutate(order = 1:nrow(.)) %>%
  gather(factor, loading, -question, -order)
```

```{r, fig.width = 3, fig.asp = 1}
d1_vt_loadings %>%
  mutate(question = gsub("_abs", "", question)) %>%
  ggplot(aes(x = factor, y = reorder(question, desc(order)), fill = loading)) +
  geom_tile(color = "black") +
  geom_text(aes(label = format(round(loading, 2), nsmall = 2)), size = 3) +
  scale_fill_distiller(palette = "RdYlBu", limits = c(-1, 1)) +
  labs(title = "Study 1: Vanuatu", x = "factor", y = "question")
```

## Study 3

### All sites

```{r}
d3_abs <- d3_byq %>%
  select(subj, question, response) %>%
  filter(question %in% c("exwl_01", "exwl_02", "exwl_03", "exwl_04", "exwl_05", "exwl_06",
                         "exwl_07", "exwl_08", "exwl_09", "exwl_10", "exwl_11", "exwl_12",
                         "exwl_13", "exwl_14", "exwl_15", "exwl_16", "exwl_17", "exwl_18",
                         "exwl_19", "exwl_20", "exwl_21", "exwl_22", "exwl_23", "exwl_24",
                         "exwl_25", "exwl_26", "exwl_27", "exwl_28", "exwl_29", "exwl_30",
                         "exwl_31", "exwl_32", "exwl_33", "exwl_34")) %>%
  mutate(question = factor(
    question,
    levels = c("exwl_01", "exwl_02", "exwl_03", "exwl_04", 
               "exwl_05", "exwl_06", "exwl_07", "exwl_08", 
               "exwl_09", "exwl_10", "exwl_11", "exwl_12",
               "exwl_13", "exwl_14", "exwl_15", "exwl_16", 
               "exwl_17", "exwl_18", "exwl_19", "exwl_20", 
               "exwl_21", "exwl_22", "exwl_23", "exwl_24",
               "exwl_25", "exwl_26", "exwl_27", "exwl_28", 
               "exwl_29", "exwl_30", "exwl_31", "exwl_32", 
               "exwl_33", "exwl_34"),
    labels = c("childexp", "poeticlanguage", "forgetsurrounding", "starepicture", 
               "mindenvelopworld", "cloudshapes", "vividdaydream", "mysticalexp", 
               "stepoutsidemyself", "textures", "doublyreal", "caughtupinmusic", 
               "heavybody", "sensepresence", "woodfireimagine", "immersednature", 
               "colormeaning", "wanderthoughtstask", "clearpastexp", "meaninglesstoothers", 
               "actinginplay", "visualthoughts", "delightsmallthings", "organmusic", 
               "changenoise", "vividsmellmemories", "synesthesiasound", "predictwords", 
               "physicalmemories", "fascinatingvoice", "invisiblepresence", "sponthoughtsimages", 
               "synesthesiasmell", "emosunset"))) %>%
  spread(question, response) %>%
  column_to_rownames("subj")
```

```{r}
fa.parallel(d3_abs)
```

```{r}
d3_all_efa <- fa(d3_abs, nfactors = 6, rotate = "oblimin")
```

```{r}
d3_all_loadings <- d3_all_efa$loadings[] %>% 
  fa.sort() %>%
  data.frame() %>%
  rownames_to_column("question") %>%
  mutate(order = 1:nrow(.)) %>%
  gather(factor, loading, -question, -order)
```

```{r, fig.width = 3, fig.asp = 1}
d3_all_loadings %>%
  mutate(question = gsub("_abs", "", question)) %>%
  ggplot(aes(x = factor, y = reorder(question, desc(order)), fill = loading)) +
  geom_tile(color = "black") +
  geom_text(aes(label = format(round(loading, 2), nsmall = 2)), size = 3) +
  scale_fill_distiller(palette = "RdYlBu", limits = c(-1, 1)) +
  labs(title = "Study 3: All sites", x = "factor", y = "question")
```

### US

```{r}
d3_abs_us <- d3_abs %>%
  rownames_to_column("subj") %>%
  filter(subj %in% c(d3_byq %>% filter(ctry == "us") %>% distinct(subj) %>% pull(subj))) %>%
  column_to_rownames("subj")
```

```{r}
fa.parallel(d3_abs_us)
```

```{r}
d3_us_efa <- fa(d3_abs, nfactors = 4, rotate = "oblimin")
```

```{r}
d3_us_loadings <- d3_us_efa$loadings[] %>% 
  fa.sort() %>%
  data.frame() %>%
  rownames_to_column("question") %>%
  mutate(order = 1:nrow(.)) %>%
  gather(factor, loading, -question, -order)
```

```{r, fig.width = 3, fig.asp = 1}
d3_us_loadings %>%
  mutate(question = gsub("_abs", "", question)) %>%
  ggplot(aes(x = factor, y = reorder(question, desc(order)), fill = loading)) +
  geom_tile(color = "black") +
  geom_text(aes(label = format(round(loading, 2), nsmall = 2)), size = 3) +
  scale_fill_distiller(palette = "RdYlBu", limits = c(-1, 1)) +
  labs(title = "Study 3: US", x = "factor", y = "question")
```

### Ghana

```{r}
d3_abs_gh <- d3_abs %>%
  rownames_to_column("subj") %>%
  filter(subj %in% c(d3_byq %>% filter(ctry == "ghana") %>% distinct(subj) %>% pull(subj))) %>%
  column_to_rownames("subj")
```

```{r}
fa.parallel(d3_abs_gh)
```

```{r}
d3_gh_efa <- fa(d3_abs, nfactors = 2, rotate = "oblimin")
```

```{r}
d3_gh_loadings <- d3_gh_efa$loadings[] %>% 
  fa.sort() %>%
  data.frame() %>%
  rownames_to_column("question") %>%
  mutate(order = 1:nrow(.)) %>%
  gather(factor, loading, -question, -order)
```

```{r, fig.width = 3, fig.asp = 1}
d3_gh_loadings %>%
  mutate(question = gsub("_abs", "", question)) %>%
  ggplot(aes(x = factor, y = reorder(question, desc(order)), fill = loading)) +
  geom_tile(color = "black") +
  geom_text(aes(label = format(round(loading, 2), nsmall = 2)), size = 3) +
  scale_fill_distiller(palette = "RdYlBu", limits = c(-1, 1)) +
  labs(title = "Study 3: Ghana", x = "factor", y = "question")
```

### Thailand

```{r}
d3_abs_th <- d3_abs %>%
  rownames_to_column("subj") %>%
  filter(subj %in% c(d3_byq %>% filter(ctry == "thailand") %>% distinct(subj) %>% pull(subj))) %>%
  column_to_rownames("subj")
```

```{r}
fa.parallel(d3_abs_th)
```

```{r}
d3_th_efa <- fa(d3_abs, nfactors = 1, rotate = "oblimin")
```

```{r}
d3_th_loadings <- d3_th_efa$loadings[] %>% 
  fa.sort() %>%
  data.frame() %>%
  rownames_to_column("question") %>%
  mutate(order = 1:nrow(.)) %>%
  gather(factor, loading, -question, -order)
```

```{r, fig.width = 3, fig.asp = 1}
d3_th_loadings %>%
  mutate(question = gsub("_abs", "", question)) %>%
  ggplot(aes(x = factor, y = reorder(question, desc(order)), fill = loading)) +
  geom_tile(color = "black") +
  geom_text(aes(label = format(round(loading, 2), nsmall = 2)), size = 3) +
  scale_fill_distiller(palette = "RdYlBu", limits = c(-1, 1)) +
  labs(title = "Study 3: Thailand", x = "factor", y = "question")
```

### China

```{r}
d3_abs_ch <- d3_abs %>%
  rownames_to_column("subj") %>%
  filter(subj %in% c(d3_byq %>% filter(ctry == "china") %>% distinct(subj) %>% pull(subj))) %>%
  column_to_rownames("subj")
```

```{r}
fa.parallel(d3_abs_ch)
```

```{r}
d3_ch_efa <- fa(d3_abs, nfactors = 2, rotate = "oblimin")
```

```{r}
d3_ch_loadings <- d3_ch_efa$loadings[] %>% 
  fa.sort() %>%
  data.frame() %>%
  rownames_to_column("question") %>%
  mutate(order = 1:nrow(.)) %>%
  gather(factor, loading, -question, -order)
```

```{r, fig.width = 3, fig.asp = 1}
d3_ch_loadings %>%
  mutate(question = gsub("_abs", "", question)) %>%
  ggplot(aes(x = factor, y = reorder(question, desc(order)), fill = loading)) +
  geom_tile(color = "black") +
  geom_text(aes(label = format(round(loading, 2), nsmall = 2)), size = 3) +
  scale_fill_distiller(palette = "RdYlBu", limits = c(-1, 1)) +
  labs(title = "Study 3: China", x = "factor", y = "question")
```

### Vanuatu

```{r}
d3_abs_vt <- d3_abs %>%
  rownames_to_column("subj") %>%
  filter(subj %in% c(d3_byq %>% filter(ctry == "vanuatu") %>% distinct(subj) %>% pull(subj))) %>%
  column_to_rownames("subj")
```

```{r}
fa.parallel(d3_abs_vt)
```

```{r}
d3_vt_efa <- fa(d3_abs, nfactors = 2, rotate = "oblimin")
```

```{r}
d3_vt_loadings <- d3_vt_efa$loadings[] %>% 
  fa.sort() %>%
  data.frame() %>%
  rownames_to_column("question") %>%
  mutate(order = 1:nrow(.)) %>%
  gather(factor, loading, -question, -order)
```

```{r, fig.width = 3, fig.asp = 1}
d3_vt_loadings %>%
  mutate(question = gsub("_abs", "", question)) %>%
  ggplot(aes(x = factor, y = reorder(question, desc(order)), fill = loading)) +
  geom_tile(color = "black") +
  geom_text(aes(label = format(round(loading, 2), nsmall = 2)), size = 3) +
  scale_fill_distiller(palette = "RdYlBu", limits = c(-1, 1)) +
  labs(title = "Study 3: Vanuatu", x = "factor", y = "question")
```

## Study 4

### All sites

```{r}
d4_abs <- d4_byq %>%
  select(p7_subj, contains("_abs_")) %>%
  select(-ends_with("cat"), -ends_with("total"), -contains("_check")) %>%
  column_to_rownames("p7_subj")
```

```{r}
fa.parallel(d4_abs)
```

```{r}
d4_all_efa <- fa(d4_abs, nfactors = 4, rotate = "oblimin")
```

```{r}
d4_all_loadings <- d4_all_efa$loadings[] %>% 
  fa.sort() %>%
  data.frame() %>%
  rownames_to_column("question") %>%
  mutate(order = 1:nrow(.)) %>%
  gather(factor, loading, -question, -order)
```

```{r, fig.width = 3, fig.asp = 1}
d4_all_loadings %>%
  mutate(question = gsub("_abs", "", question),
         question = gsub("p7_", "", question)) %>%
  ggplot(aes(x = factor, y = reorder(question, desc(order)), fill = loading)) +
  geom_tile(color = "black") +
  geom_text(aes(label = format(round(loading, 2), nsmall = 2)), size = 3) +
  scale_fill_distiller(palette = "RdYlBu", limits = c(-1, 1)) +
  labs(title = "Study 4: All sites", x = "factor", y = "question")
```

### US

```{r}
d4_abs_us <- d4_abs %>%
  rownames_to_column("p7_subj") %>%
  filter(p7_subj %in% c(d4_byq %>% 
                          filter(p7_ctry == "US") %>% 
                          distinct(p7_subj) %>% 
                          pull(p7_subj))) %>%
  column_to_rownames("p7_subj")
```

```{r}
fa.parallel(d4_abs_us)
```

```{r}
d4_us_efa <- fa(d4_abs_us, nfactors = 2, rotate = "oblimin")
```

```{r}
d4_us_loadings <- d4_us_efa$loadings[] %>% 
  fa.sort() %>%
  data.frame() %>%
  rownames_to_column("question") %>%
  mutate(order = 1:nrow(.)) %>%
  gather(factor, loading, -question, -order)
```

```{r, fig.width = 3, fig.asp = 1}
d4_us_loadings %>%
  mutate(question = gsub("_abs", "", question),
         question = gsub("p7_", "", question)) %>%
  ggplot(aes(x = factor, y = reorder(question, desc(order)), fill = loading)) +
  geom_tile(color = "black") +
  geom_text(aes(label = format(round(loading, 2), nsmall = 2)), size = 3) +
  scale_fill_distiller(palette = "RdYlBu", limits = c(-1, 1)) +
  labs(title = "Study 4: US", x = "factor", y = "question")
```

### Ghana

```{r}
d4_abs_gh <- d4_abs %>%
  rownames_to_column("p7_subj") %>%
  filter(p7_subj %in% c(d4_byq %>% 
                          filter(p7_ctry == "Ghana") %>% 
                          distinct(p7_subj) %>% 
                          pull(p7_subj))) %>%
  column_to_rownames("p7_subj")
```

```{r}
fa.parallel(d4_abs_gh)
```

```{r}
d4_gh_efa <- fa(d4_abs_gh, nfactors = 4, rotate = "oblimin")
```

```{r}
d4_gh_loadings <- d4_gh_efa$loadings[] %>% 
  fa.sort() %>%
  data.frame() %>%
  rownames_to_column("question") %>%
  mutate(order = 1:nrow(.)) %>%
  gather(factor, loading, -question, -order)
```

```{r, fig.width = 3, fig.asp = 1}
d4_gh_loadings %>%
  mutate(question = gsub("_abs", "", question),
         question = gsub("p7_", "", question)) %>%
  ggplot(aes(x = factor, y = reorder(question, desc(order)), fill = loading)) +
  geom_tile(color = "black") +
  geom_text(aes(label = format(round(loading, 2), nsmall = 2)), size = 3) +
  scale_fill_distiller(palette = "RdYlBu", limits = c(-1, 1)) +
  labs(title = "Study 4: Ghana", x = "factor", y = "question")
```

### Thailand

```{r}
d4_abs_th <- d4_abs %>%
  rownames_to_column("p7_subj") %>%
  filter(p7_subj %in% c(d4_byq %>% 
                          filter(p7_ctry == "Thailand") %>% 
                          distinct(p7_subj) %>% 
                          pull(p7_subj))) %>%
  column_to_rownames("p7_subj")
```

```{r}
fa.parallel(d4_abs_th)
```

```{r}
d4_th_efa <- fa(d4_abs_th, nfactors = 1, rotate = "oblimin")
```

```{r}
d4_th_loadings <- d4_th_efa$loadings[] %>% 
  fa.sort() %>%
  data.frame() %>%
  rownames_to_column("question") %>%
  mutate(order = 1:nrow(.)) %>%
  gather(factor, loading, -question, -order)
```

```{r, fig.width = 3, fig.asp = 1}
d4_th_loadings %>%
  mutate(question = gsub("_abs", "", question)) %>%
  ggplot(aes(x = factor, y = reorder(question, desc(order)), fill = loading)) +
  geom_tile(color = "black") +
  geom_text(aes(label = format(round(loading, 2), nsmall = 2)), size = 3) +
  scale_fill_distiller(palette = "RdYlBu", limits = c(-1, 1)) +
  labs(title = "Study 4: Thailand", x = "factor", y = "question")
```

### China

```{r}
d4_abs_ch <- d4_abs %>%
  rownames_to_column("p7_subj") %>%
  filter(p7_subj %in% c(d4_byq %>% 
                          filter(p7_ctry == "China") %>% 
                          distinct(p7_subj) %>% 
                          pull(p7_subj))) %>%
  column_to_rownames("p7_subj")
```

```{r}
fa.parallel(d4_abs_ch)
```

```{r}
d4_ch_efa <- fa(d4_abs_ch, nfactors = 1, rotate = "oblimin")
```

```{r}
d4_ch_loadings <- d4_ch_efa$loadings[] %>% 
  fa.sort() %>%
  data.frame() %>%
  rownames_to_column("question") %>%
  mutate(order = 1:nrow(.)) %>%
  gather(factor, loading, -question, -order)
```

```{r, fig.width = 3, fig.asp = 1}
d4_ch_loadings %>%
  mutate(question = gsub("_abs", "", question),
         question = gsub("p7_", "", question)) %>%
  ggplot(aes(x = factor, y = reorder(question, desc(order)), fill = loading)) +
  geom_tile(color = "black") +
  geom_text(aes(label = format(round(loading, 2), nsmall = 2)), size = 3) +
  scale_fill_distiller(palette = "RdYlBu", limits = c(-1, 1)) +
  labs(title = "Study 4: China", x = "factor", y = "question")
```

### Vanuatu

```{r}
d4_abs_vt <- d4_abs %>%
  rownames_to_column("p7_subj") %>%
  filter(p7_subj %in% c(d4_byq %>% 
                          filter(p7_ctry == "Vanuatu") %>% 
                          distinct(p7_subj) %>% 
                          pull(p7_subj))) %>%
  column_to_rownames("p7_subj")
```

```{r}
fa.parallel(d4_abs_vt)
```

```{r}
d4_vt_efa <- fa(d4_abs_vt, nfactors = 6, rotate = "oblimin")
```

```{r}
d4_vt_loadings <- d4_vt_efa$loadings[] %>% 
  fa.sort() %>%
  data.frame() %>%
  rownames_to_column("question") %>%
  mutate(order = 1:nrow(.)) %>%
  gather(factor, loading, -question, -order)
```

```{r, fig.width = 3, fig.asp = 1}
d4_vt_loadings %>%
  mutate(question = gsub("_abs", "", question),
         question = gsub("p7_", "", question)) %>%
  ggplot(aes(x = factor, y = reorder(question, desc(order)), fill = loading)) +
  geom_tile(color = "black") +
  geom_text(aes(label = format(round(loading, 2), nsmall = 2)), size = 3) +
  scale_fill_distiller(palette = "RdYlBu", limits = c(-1, 1)) +
  labs(title = "Study 4: Vanuatu", x = "factor", y = "question")
```

## All studies

```{r}
d_all_abs <- d1_abs %>% 
  rename_all(~gsub("_abs", "", .)) %>%
  rownames_to_column("subject_id") %>%
  mutate(study = "s1") %>%
  gather(question, response, -c(study, subject_id)) %>%
  full_join(d3_abs %>%
              rownames_to_column("subject_id") %>%
              mutate(study = "s3") %>%
              gather(question, response, -c(study, subject_id))) %>%
  full_join(d4_abs %>%
              rownames_to_column("subject_id") %>%
              mutate(study = "s4") %>%
              gather(question, response, -c(study, subject_id)) %>%
              mutate(question = recode(question,
                                       "p7_abs_child.exp" = "childexp",
                                       "p7_abs_poetic" = "poeticlanguage", 
                                       "p7_abs_tv.real" = "forgetsurrounding",
                                       "p7_abs_see.image" = "starepicture",
                                       "p7_abs_mind.world" = "mindenvelopworld", 
                                       "p7_abs_clouds" = "cloudshapes", 
                                       "p7_abs_vivid.dreams" = "vividdaydream",
                                       "p7_abs_mystic.exp" = "mysticalexp", 
                                       "p7_abs_step.outside" = "stepoutsidemyself", 
                                       "p7_abs_textures" = "textures", 
                                       "p7_abs_too.real" = "doublyreal", 
                                       "p7_abs_music.attn" = "caughtupinmusic", 
                                       "p7_abs_heavy.body" = "heavybody",
                                       "p7_abs_sense.presc" = "sensepresence",
                                       "p7_abs_fire" = "woodfireimagine", 
                                       "p7_abs_nature.art" = "immersednature", 
                                       "p7_abs_colors" = "colormeaning", 
                                       "p7_abs_thght.wander" = "wanderthoughtstask", 
                                       "p7_abs_vivid.past" = "clearpastexp", 
                                       "p7_abs_makes.sense" = "meaninglesstoothers", 
                                       "p7_abs_become.chctr" = "actinginplay", 
                                       "p7_abs_visual.thghts" = "visualthoughts", 
                                       "p7_abs_small.things" = "delightsmallthings", 
                                       "p7_abs_music.lift" = "organmusic", 
                                       "p7_abs_noise.music" = "changenoise", 
                                       "p7_abs_scented.mem" = "vividsmellmemories", 
                                       "p7_abs_visual.music" = "synesthesiasound", 
                                       "p7_abs_before.said" = "predictwords", 
                                       "p7_abs_physical.mem" = "physicalmemories", 
                                       "p7_abs_voice.sound" = "fascinatingvoice", 
                                       "p7_abs_not.physical" = "invisiblepresence",
                                       "p7_abs_thgts.image" = "sponthoughtsimages", 
                                       "p7_abs_odor.to.color" = "synesthesiasmell",
                                       "p7_abs_sunset" = "emosunset"))) %>%
  unite("study_sub", c(study, subject_id)) %>%
  spread(question, response) %>%
  column_to_rownames("study_sub")
```

```{r}
fa.parallel(d_all_abs)
```

```{r}
d_all_all_efa <- fa(d_all_abs, nfactors = 6, rotate = "oblimin")
```

```{r}
d_all_all_loadings <- d_all_all_efa$loadings[] %>% 
  fa.sort() %>%
  data.frame() %>%
  rownames_to_column("question") %>%
  mutate(order = 1:nrow(.)) %>%
  gather(factor, loading, -question, -order)
```

```{r, fig.width = 3, fig.asp = 1}
d_all_all_loadings %>%
  ggplot(aes(x = factor, y = reorder(question, desc(order)), fill = loading)) +
  geom_tile(color = "black") +
  geom_text(aes(label = format(round(loading, 2), nsmall = 2)), size = 3) +
  scale_fill_distiller(palette = "RdYlBu", limits = c(-1, 1)) +
  labs(title = "All studies: All sites", x = "factor", y = "question")
```

```{r}
d_all_all_scales <- d_all_all_loadings %>%
  group_by(factor) %>% 
  top_n(3, loading) %>%
  ungroup()
```

```{r, fig.width = 3, fig.asp = 1}
d_all_all_loadings %>%
  ggplot(aes(x = factor, y = reorder(question, desc(order)), fill = loading)) +
  geom_tile(color = "black") +
  geom_tile(data = d_all_all_scales %>%
              mutate(factorlab = recode_factor(factor,
                                               "MR1" = "Synesthesia",
                                               "MR2" = "Aesthetic involvement in nature",
                                               "MR3" = "Altered states of consciousness (a)",
                                               "MR4" = "Imaginative involvement",
                                               "MR5" = "Sensed presence",
                                               "MR6" = "Altered states of consciousness (b)")),
            aes(fill = NULL, color = factorlab), alpha = 0, size = 1) +
  geom_text(aes(label = format(round(loading, 2), nsmall = 2)), size = 3) +
  scale_fill_distiller(palette = "RdYlBu", limits = c(-1, 1)) +
  scale_color_brewer(palette = "Set1") +
  labs(title = "All studies: All sites", x = "factor", y = "question",
       fill = "Factor loading", color = "MODTAS factor") +
  theme_minimal()
```

# Subscales

## Study 1

### Reliability

```{r}
# reliability
bind_rows(MR1 = summary(alpha(d_all_abs %>%
                                rownames_to_column("subject_id") %>% 
                                filter(grepl("s1_", subject_id)) %>%
                                column_to_rownames("subject_id") %>%
                                select(d_all_all_scales %>% 
                                         filter(factor == "MR1") %>% 
                                         pull(question)))),
          MR2 = summary(alpha(d_all_abs %>%
                                rownames_to_column("subject_id") %>% 
                                filter(grepl("s1_", subject_id)) %>%
                                column_to_rownames("subject_id") %>%
                                select(d_all_all_scales %>% 
                                         filter(factor == "MR2") %>% 
                                         pull(question)))),
          MR3 = summary(alpha(d_all_abs %>%
                                rownames_to_column("subject_id") %>% 
                                filter(grepl("s1_", subject_id)) %>%
                                column_to_rownames("subject_id") %>%
                                select(d_all_all_scales %>% 
                                         filter(factor == "MR3") %>% 
                                         pull(question)))),
          MR4 = summary(alpha(d_all_abs %>%
                                rownames_to_column("subject_id") %>% 
                                filter(grepl("s1_", subject_id)) %>%
                                column_to_rownames("subject_id") %>%
                                select(d_all_all_scales %>% 
                                         filter(factor == "MR4") %>% 
                                         pull(question)))),
          MR5 = summary(alpha(d_all_abs %>%
                                rownames_to_column("subject_id") %>% 
                                filter(grepl("s1_", subject_id)) %>%
                                column_to_rownames("subject_id") %>%
                                select(d_all_all_scales %>% 
                                         filter(factor == "MR5") %>% 
                                         pull(question)))),
          MR6 = summary(alpha(d_all_abs %>%
                                rownames_to_column("subject_id") %>% 
                                filter(grepl("s1_", subject_id)) %>%
                                column_to_rownames("subject_id") %>%
                                select(d_all_all_scales %>% 
                                         filter(factor == "MR6") %>% 
                                         pull(question)))))

```


### Relationships (analog to Table S20)

```{r}
d1_abs_subscales <- d1_abs %>%
  rownames_to_column("subject_id") %>%
  gather(question, response, -subject_id) %>%
  mutate(question = gsub("_abs", "", question)) %>%
  left_join(d_all_all_scales %>% distinct(question, factor)) %>% 
  filter(!is.na(factor)) %>%
  mutate(factorlab = recode_factor(factor,
                                   "MR1" = "Synesthesia",
                                   "MR2" = "Aesthetic involvement in nature",
                                   "MR3" = "Altered states of consciousness (a)",
                                   "MR4" = "Imaginative involvement",
                                   "MR5" = "Sensed presence",
                                   "MR6" = "Altered states of consciousness (b)")) %>% 
  group_by(subject_id, factor, factorlab) %>%
  summarise(score = mean(response, na.rm = T)) %>%
  ungroup() %>%
  mutate(subject_id = as.numeric(subject_id)) %>%
  left_join(d1 %>% distinct(subject_id, country)) %>%
  group_by(country, factor, factorlab) %>%
  mutate(score = scale(score)) %>%
  ungroup() %>%
  select(-country, -factor) %>%
  spread(factorlab, score) %>%
  mutate_all(as.numeric) %>%
  left_join(d1_fortab)
```

```{r}
# r104_spev <- lm(`Spiritual Events` ~ `Porosity Vignettes`,
#                data = d1_abs_subscales)

r105_spev_MR1 <- lm(`Spiritual Events` ~ Synesthesia,
                    data = d1_abs_subscales)
r105_spev_MR2 <- lm(`Spiritual Events` ~ `Aesthetic involvement in nature`,
                    data = d1_abs_subscales)
r105_spev_MR3 <- lm(`Spiritual Events` ~ `Altered states of consciousness (a)`,
                    data = d1_abs_subscales)
r105_spev_MR4 <- lm(`Spiritual Events` ~ `Imaginative involvement`,
                    data = d1_abs_subscales)
r105_spev_MR5 <- lm(`Spiritual Events` ~ `Sensed presence`,
                    data = d1_abs_subscales)
r105_spev_MR6 <- lm(`Spiritual Events` ~ `Altered states of consciousness (b)`,
                    data = d1_abs_subscales)

r106_spev_MR1 <- lm(`Spiritual Events` ~ `Porosity Vignettes` * Synesthesia,
                    data = d1_abs_subscales)
r106_spev_MR2 <- lm(`Spiritual Events` ~ `Porosity Vignettes` * `Aesthetic involvement in nature`,
                    data = d1_abs_subscales)
r106_spev_MR3 <- lm(`Spiritual Events` ~ `Porosity Vignettes` * `Altered states of consciousness (a)`,
                    data = d1_abs_subscales)
r106_spev_MR4 <- lm(`Spiritual Events` ~ `Porosity Vignettes` * `Imaginative involvement`,
                    data = d1_abs_subscales)
r106_spev_MR5 <- lm(`Spiritual Events` ~ `Porosity Vignettes` * `Sensed presence`,
                    data = d1_abs_subscales)
r106_spev_MR6 <- lm(`Spiritual Events` ~ `Porosity Vignettes` * `Altered states of consciousness (b)`,
                    data = d1_abs_subscales)

# r107_spev <- lm(`Spiritual Events` ~ Country * Site * Religion 
#                + `Porosity Vignettes` + Country:`Porosity Vignettes`,
#                data = d1_abs_subscales)

r108_spev_MR1 <- lm(`Spiritual Events` ~ Country * Site * Religion 
                    + Synesthesia + Country:Synesthesia,
                    data = d1_abs_subscales)
r108_spev_MR2 <- lm(`Spiritual Events` ~ Country * Site * Religion 
                    + `Aesthetic involvement in nature` + Country:`Aesthetic involvement in nature`,
                    data = d1_abs_subscales)
r108_spev_MR3 <- lm(`Spiritual Events` ~ Country * Site * Religion 
                    + `Altered states of consciousness (a)` + Country:`Altered states of consciousness (a)`,
                    data = d1_abs_subscales)
r108_spev_MR4 <- lm(`Spiritual Events` ~ Country * Site * Religion 
                    + `Imaginative involvement` + Country:`Imaginative involvement`,
                    data = d1_abs_subscales)
r108_spev_MR5 <- lm(`Spiritual Events` ~ Country * Site * Religion 
                    + `Sensed presence` + Country:`Sensed presence`,
                    data = d1_abs_subscales)
r108_spev_MR6 <- lm(`Spiritual Events` ~ Country * Site * Religion 
                    + `Altered states of consciousness (b)` + Country:`Altered states of consciousness (b)`,
                    data = d1_abs_subscales)

r109_spev_MR1 <- lm(`Spiritual Events` ~ Country * Site * Religion 
                    + `Porosity Vignettes` + Country:`Porosity Vignettes`
                    + Synesthesia + Country:Synesthesia
                    + `Porosity Vignettes`:Synesthesia 
                    + Country:`Porosity Vignettes`:Synesthesia,
                    data = d1_abs_subscales)
r109_spev_MR2 <- lm(`Spiritual Events` ~ Country * Site * Religion 
                    + `Porosity Vignettes` + Country:`Porosity Vignettes`
                    + `Aesthetic involvement in nature` + Country:`Aesthetic involvement in nature`
                    + `Porosity Vignettes`:`Aesthetic involvement in nature` 
                    + Country:`Porosity Vignettes`:`Aesthetic involvement in nature`,
                    data = d1_abs_subscales)
r109_spev_MR3 <- lm(`Spiritual Events` ~ Country * Site * Religion 
                    + `Porosity Vignettes` + Country:`Porosity Vignettes`
                    + `Altered states of consciousness (a)` + Country:`Altered states of consciousness (a)`
                    + `Porosity Vignettes`:`Altered states of consciousness (a)` 
                    + Country:`Porosity Vignettes`:`Altered states of consciousness (a)`,
                    data = d1_abs_subscales)
r109_spev_MR4 <- lm(`Spiritual Events` ~ Country * Site * Religion 
                    + `Porosity Vignettes` + Country:`Porosity Vignettes`
                    + `Imaginative involvement` + Country:`Imaginative involvement`
                    + `Porosity Vignettes`:`Imaginative involvement` 
                    + Country:`Porosity Vignettes`:`Imaginative involvement`,
                    data = d1_abs_subscales)
r109_spev_MR5 <- lm(`Spiritual Events` ~ Country * Site * Religion 
                    + `Porosity Vignettes` + Country:`Porosity Vignettes`
                    + `Sensed presence` + Country:`Sensed presence`
                    + `Porosity Vignettes`:`Sensed presence` 
                    + Country:`Porosity Vignettes`:`Sensed presence`,
                    data = d1_abs_subscales)
r109_spev_MR6 <- lm(`Spiritual Events` ~ Country * Site * Religion 
                    + `Porosity Vignettes` + Country:`Porosity Vignettes`
                    + `Altered states of consciousness (b)` + Country:`Altered states of consciousness (b)`
                    + `Porosity Vignettes`:`Altered states of consciousness (b)` 
                    + Country:`Porosity Vignettes`:`Altered states of consciousness (b)`,
                    data = d1_abs_subscales)

r110_spev_MR1 <- lm(`Spiritual Events` ~ Country * Site * Religion 
                   + `Porosity Vignettes` + Country:`Porosity Vignettes`
                   + Synesthesia + Country:Synesthesia
                   + `Porosity Vignettes`:Synesthesia
                   + Country:`Porosity Vignettes`:Synesthesia
                   + Gender + Age + Education,
                   data = d1_abs_subscales)
r110_spev_MR2 <- lm(`Spiritual Events` ~ Country * Site * Religion 
                   + `Porosity Vignettes` + Country:`Porosity Vignettes`
                   + `Aesthetic involvement in nature` + Country:`Aesthetic involvement in nature`
                   + `Porosity Vignettes`:`Aesthetic involvement in nature`
                   + Country:`Porosity Vignettes`:`Aesthetic involvement in nature`
                   + Gender + Age + Education,
                   data = d1_abs_subscales)
r110_spev_MR3 <- lm(`Spiritual Events` ~ Country * Site * Religion 
                   + `Porosity Vignettes` + Country:`Porosity Vignettes`
                   + `Altered states of consciousness (a)` + Country:`Altered states of consciousness (a)`
                   + `Porosity Vignettes`:`Altered states of consciousness (a)`
                   + Country:`Porosity Vignettes`:`Altered states of consciousness (a)`
                   + Gender + Age + Education,
                   data = d1_abs_subscales)
r110_spev_MR4 <- lm(`Spiritual Events` ~ Country * Site * Religion 
                   + `Porosity Vignettes` + Country:`Porosity Vignettes`
                   + `Imaginative involvement` + Country:`Imaginative involvement`
                   + `Porosity Vignettes`:`Imaginative involvement`
                   + Country:`Porosity Vignettes`:`Imaginative involvement`
                   + Gender + Age + Education,
                   data = d1_abs_subscales)
r110_spev_MR5 <- lm(`Spiritual Events` ~ Country * Site * Religion 
                   + `Porosity Vignettes` + Country:`Porosity Vignettes`
                   + `Sensed presence` + Country:`Sensed presence`
                   + `Porosity Vignettes`:`Sensed presence`
                   + Country:`Porosity Vignettes`:`Sensed presence`
                   + Gender + Age + Education,
                   data = d1_abs_subscales)
r110_spev_MR6 <- lm(`Spiritual Events` ~ Country * Site * Religion 
                   + `Porosity Vignettes` + Country:`Porosity Vignettes`
                   + `Altered states of consciousness (b)` + Country:`Altered states of consciousness (b)`
                   + `Porosity Vignettes`:`Altered states of consciousness (b)`
                   + Country:`Porosity Vignettes`:`Altered states of consciousness (b)`
                   + Gender + Age + Education,
                   data = d1_abs_subscales)
```

```{r, include = F}
# # run manually to check convergence
# # summary(r104_spev)
# summary(r105_spev)
# summary(r106_spev)
# # summary(r107_spev)
# summary(r108_spev)
# summary(r109_spev)
# summary(r110_spev)
```

```{r, results = "hide"}
table_s20_subscales <- stargazer(
  #r104_spev, 
  r105_spev_MR1, r105_spev_MR2, r105_spev_MR3, r105_spev_MR4, r105_spev_MR5, r105_spev_MR6,
  r106_spev_MR1, r106_spev_MR2, r106_spev_MR3, r106_spev_MR4, r106_spev_MR5, r106_spev_MR6,
  #r107_spev, 
  r108_spev_MR1, r108_spev_MR2, r108_spev_MR3, r108_spev_MR4, r108_spev_MR5, r108_spev_MR6,
  r109_spev_MR1, r109_spev_MR2, r109_spev_MR3, r109_spev_MR4, r109_spev_MR5, r109_spev_MR6,
  r110_spev_MR1, r110_spev_MR2, r110_spev_MR3, r110_spev_MR4, r110_spev_MR5, r110_spev_MR6,
  type = "html",
  ci = T,
  report = c("vcsp"),
  digits = 2,
  digits.extra = 1000,
  omit.table.layout = "n",
  # order = c("^`Porosity Vignettes`$",
  #           "^Absorption$",
  #           "^`Porosity Vignettes`:Absorption$"),
  # dep.var.labels.include = F,
  dep.var.caption = "",
  single.row = T)

cat(sub_interact_fun(table_s20_subscales), 
    file = "./stargazer_tables/table_s20_subscales.html")
```

```{r}
# htmltools::includeHTML("./stargazer_tables/table_s20_subscales.html")
```

```{r, results = "hide"}
table_s20_subscales_MR1 <- stargazer(#r104_spev,
                                     r105_spev_MR1, r106_spev_MR1, 
                                     #r107_spev, 
                                     r108_spev_MR1, r109_spev_MR1, r110_spev_MR1, 
                                     type = "html",
                                     ci = T,
                                     report = c("vcsp"),
                                     digits = 2,
                                     digits.extra = 1000,
                                     omit.table.layout = "n",
                                     order = c("^`Porosity Vignettes`$",
                                               "^Synesthesia$",
                                               "^`Porosity Vignettes`:Synesthesia$"),
                                     dep.var.labels.include = F,
                                     dep.var.caption = "",
                                     single.row = T)

cat(sub_interact_fun(table_s20_subscales_MR1), 
    file = "./stargazer_tables/table_s20_subscales_MR1.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s20_subscales_MR1.html")
```

```{r, results = "hide"}
table_s20_subscales_MR2 <- stargazer(#r104_spev,
                                     r105_spev_MR2, r106_spev_MR2, 
                                     #r107_spev, 
                                     r108_spev_MR2, r109_spev_MR2, r110_spev_MR2, 
                                     type = "html",
                                     ci = T,
                                     report = c("vcsp"),
                                     digits = 2,
                                     digits.extra = 1000,
                                     omit.table.layout = "n",
                                     order = c("^`Porosity Vignettes`$",
                                               "^`Aesthetic involvement in nature`$",
                                               "^`Porosity Vignettes`:`Aesthetic involvement in nature`$"),
                                     dep.var.labels.include = F,
                                     dep.var.caption = "",
                                     single.row = T)

cat(sub_interact_fun(table_s20_subscales_MR2), 
    file = "./stargazer_tables/table_s20_subscales_MR2.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s20_subscales_MR2.html")
```

```{r, results = "hide"}
table_s20_subscales_MR3 <- stargazer(#r104_spev,
                                     r105_spev_MR3, r106_spev_MR3, 
                                     #r107_spev, 
                                     r108_spev_MR3, r109_spev_MR3, r110_spev_MR3, 
                                     type = "html",
                                     ci = T,
                                     report = c("vcsp"),
                                     digits = 2,
                                     digits.extra = 1000,
                                     omit.table.layout = "n",
                                     order = c("^`Porosity Vignettes`$",
                                               "^`Altered states of consciousness \\(a\\)`$",
                                               "^`Porosity Vignettes`:`Altered states of consciousness \\(a\\)`$"),
                                     dep.var.labels.include = F,
                                     dep.var.caption = "",
                                     single.row = T)

cat(sub_interact_fun(table_s20_subscales_MR3), 
    file = "./stargazer_tables/table_s20_subscales_MR3.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s20_subscales_MR3.html")
```

```{r, results = "hide"}
table_s20_subscales_MR4 <- stargazer(#r104_spev,
                                     r105_spev_MR4, r106_spev_MR4, 
                                     #r107_spev, 
                                     r108_spev_MR4, r109_spev_MR4, r110_spev_MR4, 
                                     type = "html",
                                     ci = T,
                                     report = c("vcsp"),
                                     digits = 2,
                                     digits.extra = 1000,
                                     omit.table.layout = "n",
                                     order = c("^`Porosity Vignettes`$",
                                               "^`Imaginative involvement`$",
                                               "^`Porosity Vignettes`:`Imaginative involvement`$"),
                                     dep.var.labels.include = F,
                                     dep.var.caption = "",
                                     single.row = T)

cat(sub_interact_fun(table_s20_subscales_MR4), 
    file = "./stargazer_tables/table_s20_subscales_MR4.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s20_subscales_MR4.html")
```

```{r, results = "hide"}
table_s20_subscales_MR5 <- stargazer(#r104_spev,
                                     r105_spev_MR5, r106_spev_MR5, 
                                     #r107_spev, 
                                     r108_spev_MR5, r109_spev_MR5, r110_spev_MR5, 
                                     type = "html",
                                     ci = T,
                                     report = c("vcsp"),
                                     digits = 2,
                                     digits.extra = 1000,
                                     omit.table.layout = "n",
                                     order = c("^`Porosity Vignettes`$",
                                               "^`Sensed presence`$",
                                               "^`Porosity Vignettes`:`Sensed presence`$"),
                                     dep.var.labels.include = F,
                                     dep.var.caption = "",
                                     single.row = T)

cat(sub_interact_fun(table_s20_subscales_MR5), 
    file = "./stargazer_tables/table_s20_subscales_MR5.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s20_subscales_MR5.html")
```

```{r, results = "hide"}
table_s20_subscales_MR6 <- stargazer(#r104_spev,
                                     r105_spev_MR6, r106_spev_MR6, 
                                     #r107_spev, 
                                     r108_spev_MR6, r109_spev_MR6, r110_spev_MR6, 
                                     type = "html",
                                     ci = T,
                                     report = c("vcsp"),
                                     digits = 2,
                                     digits.extra = 1000,
                                     omit.table.layout = "n",
                                     order = c("^`Porosity Vignettes`$",
                                               "^`Altered states of consciousness \\(b\\)`$",
                                               "^`Porosity Vignettes`:`Altered states of consciousness \\(b\\)`$"),
                                     dep.var.labels.include = F,
                                     dep.var.caption = "",
                                     single.row = T)

cat(sub_interact_fun(table_s20_subscales_MR6), 
    file = "./stargazer_tables/table_s20_subscales_MR6.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s20_subscales_MR6.html")
```

## Study 3

### Reliability

```{r}
# reliability
bind_rows(MR1 = summary(alpha(d_all_abs %>%
                                rownames_to_column("subject_id") %>% 
                                filter(grepl("s3_", subject_id)) %>%
                                column_to_rownames("subject_id") %>%
                                select(d_all_all_scales %>% 
                                         filter(factor == "MR1") %>% 
                                         pull(question)))),
          MR2 = summary(alpha(d_all_abs %>%
                                rownames_to_column("subject_id") %>% 
                                filter(grepl("s3_", subject_id)) %>%
                                column_to_rownames("subject_id") %>%
                                select(d_all_all_scales %>% 
                                         filter(factor == "MR2") %>% 
                                         pull(question)))),
          MR3 = summary(alpha(d_all_abs %>%
                                rownames_to_column("subject_id") %>% 
                                filter(grepl("s3_", subject_id)) %>%
                                column_to_rownames("subject_id") %>%
                                select(d_all_all_scales %>% 
                                         filter(factor == "MR3") %>% 
                                         pull(question)))),
          MR4 = summary(alpha(d_all_abs %>%
                                rownames_to_column("subject_id") %>% 
                                filter(grepl("s3_", subject_id)) %>%
                                column_to_rownames("subject_id") %>%
                                select(d_all_all_scales %>% 
                                         filter(factor == "MR4") %>% 
                                         pull(question)))),
          MR5 = summary(alpha(d_all_abs %>%
                                rownames_to_column("subject_id") %>% 
                                filter(grepl("s3_", subject_id)) %>%
                                column_to_rownames("subject_id") %>%
                                select(d_all_all_scales %>% 
                                         filter(factor == "MR5") %>% 
                                         pull(question)))),
          MR6 = summary(alpha(d_all_abs %>%
                                rownames_to_column("subject_id") %>% 
                                filter(grepl("s3_", subject_id)) %>%
                                column_to_rownames("subject_id") %>%
                                select(d_all_all_scales %>% 
                                         filter(factor == "MR6") %>% 
                                         pull(question)))))

```


### Relationships (analog to Table S32)

```{r}
d3_abs_subscales <- d3_abs %>%
  rownames_to_column("subject_id") %>%
  gather(question, response, -subject_id) %>%
  mutate(question = gsub("_abs", "", question)) %>%
  left_join(d_all_all_scales %>% distinct(question, factor)) %>% 
  filter(!is.na(factor)) %>%
  mutate(factorlab = recode_factor(factor,
                                   "MR1" = "Synesthesia",
                                   "MR2" = "Aesthetic involvement in nature",
                                   "MR3" = "Altered states of consciousness (a)",
                                   "MR4" = "Imaginative involvement",
                                   "MR5" = "Sensed presence",
                                   "MR6" = "Altered states of consciousness (b)")) %>% 
  group_by(subject_id, factor, factorlab) %>%
  summarise(score = mean(response, na.rm = T)) %>%
  ungroup() %>%
  mutate(subject_id = as.numeric(subject_id)) %>%
  left_join(d3 %>% distinct(subject_id, country)) %>%
  group_by(country, factor, factorlab) %>%
  mutate(score = scale(score)) %>%
  ungroup() %>%
  select(-country, -factor) %>%
  spread(factorlab, score) %>%
  mutate_all(as.numeric) %>%
  left_join(d3_fortab)
```

```{r}
r103_spev_MR1 <- lm(`Spiritual Events` ~ `Synesthesia`,
                    data = d3_abs_subscales)
r103_spev_MR2 <- lm(`Spiritual Events` ~ `Aesthetic involvement in nature`,
                    data = d3_abs_subscales)
r103_spev_MR3 <- lm(`Spiritual Events` ~ `Altered states of consciousness (a)`,
                    data = d3_abs_subscales)
r103_spev_MR4 <- lm(`Spiritual Events` ~ `Imaginative involvement`,
                    data = d3_abs_subscales)
r103_spev_MR5 <- lm(`Spiritual Events` ~ `Sensed presence`,
                    data = d3_abs_subscales)
r103_spev_MR6 <- lm(`Spiritual Events` ~ `Altered states of consciousness (b)`,
                    data = d3_abs_subscales)

r104_spev_MR1 <- lm(`Spiritual Events` ~ Country * `Synesthesia`,
                    data = d3_abs_subscales)
r104_spev_MR2 <- lm(`Spiritual Events` ~ Country * `Aesthetic involvement in nature`,
                    data = d3_abs_subscales)
r104_spev_MR3 <- lm(`Spiritual Events` ~ Country * `Altered states of consciousness (a)`,
                    data = d3_abs_subscales)
r104_spev_MR4 <- lm(`Spiritual Events` ~ Country * `Imaginative involvement`,
                    data = d3_abs_subscales)
r104_spev_MR5 <- lm(`Spiritual Events` ~ Country * `Sensed presence`,
                    data = d3_abs_subscales)
r104_spev_MR6 <- lm(`Spiritual Events` ~ Country * `Altered states of consciousness (b)`,
                    data = d3_abs_subscales)

r105_spev_MR1 <- lm(`Spiritual Events` ~ Country * `Synesthesia`
                    + Gender + Age,  
                    data = d3_abs_subscales)
r105_spev_MR2 <- lm(`Spiritual Events` ~ Country * `Aesthetic involvement in nature`
                    + Gender + Age,  
                    data = d3_abs_subscales)
r105_spev_MR3 <- lm(`Spiritual Events` ~ Country * `Altered states of consciousness (a)`
                    + Gender + Age,  
                    data = d3_abs_subscales)
r105_spev_MR4 <- lm(`Spiritual Events` ~ Country * `Imaginative involvement`
                    + Gender + Age,  
                    data = d3_abs_subscales)
r105_spev_MR5 <- lm(`Spiritual Events` ~ Country * `Sensed presence`
                    + Gender + Age,  
                    data = d3_abs_subscales)
r105_spev_MR6 <- lm(`Spiritual Events` ~ Country * `Altered states of consciousness (b)`
                    + Gender + Age,  
                    data = d3_abs_subscales)
```

```{r}
r103_dse_MR1 <- lm(`Daily Spiritual Experiences` ~ `Synesthesia`,
                    data = d3_abs_subscales)
r103_dse_MR2 <- lm(`Daily Spiritual Experiences` ~ `Aesthetic involvement in nature`,
                    data = d3_abs_subscales)
r103_dse_MR3 <- lm(`Daily Spiritual Experiences` ~ `Altered states of consciousness (a)`,
                    data = d3_abs_subscales)
r103_dse_MR4 <- lm(`Daily Spiritual Experiences` ~ `Imaginative involvement`,
                    data = d3_abs_subscales)
r103_dse_MR5 <- lm(`Daily Spiritual Experiences` ~ `Sensed presence`,
                    data = d3_abs_subscales)
r103_dse_MR6 <- lm(`Daily Spiritual Experiences` ~ `Altered states of consciousness (b)`,
                    data = d3_abs_subscales)

r104_dse_MR1 <- lm(`Daily Spiritual Experiences` ~ Country * `Synesthesia`,
                    data = d3_abs_subscales)
r104_dse_MR2 <- lm(`Daily Spiritual Experiences` ~ Country * `Aesthetic involvement in nature`,
                    data = d3_abs_subscales)
r104_dse_MR3 <- lm(`Daily Spiritual Experiences` ~ Country * `Altered states of consciousness (a)`,
                    data = d3_abs_subscales)
r104_dse_MR4 <- lm(`Daily Spiritual Experiences` ~ Country * `Imaginative involvement`,
                    data = d3_abs_subscales)
r104_dse_MR5 <- lm(`Daily Spiritual Experiences` ~ Country * `Sensed presence`,
                    data = d3_abs_subscales)
r104_dse_MR6 <- lm(`Daily Spiritual Experiences` ~ Country * `Altered states of consciousness (b)`,
                    data = d3_abs_subscales)

r105_dse_MR1 <- lm(`Daily Spiritual Experiences` ~ Country * `Synesthesia`
                    + Gender + Age,  
                    data = d3_abs_subscales)
r105_dse_MR2 <- lm(`Daily Spiritual Experiences` ~ Country * `Aesthetic involvement in nature`
                    + Gender + Age,  
                    data = d3_abs_subscales)
r105_dse_MR3 <- lm(`Daily Spiritual Experiences` ~ Country * `Altered states of consciousness (a)`
                    + Gender + Age,  
                    data = d3_abs_subscales)
r105_dse_MR4 <- lm(`Daily Spiritual Experiences` ~ Country * `Imaginative involvement`
                    + Gender + Age,  
                    data = d3_abs_subscales)
r105_dse_MR5 <- lm(`Daily Spiritual Experiences` ~ Country * `Sensed presence`
                    + Gender + Age,  
                    data = d3_abs_subscales)
r105_dse_MR6 <- lm(`Daily Spiritual Experiences` ~ Country * `Altered states of consciousness (b)`
                    + Gender + Age,  
                    data = d3_abs_subscales)
```


```{r, results = "hide"}
table_s32_subscales <- stargazer(
  r103_spev_MR1, r103_spev_MR2, r103_spev_MR3, r103_spev_MR4, r103_spev_MR5, r103_spev_MR6,  
  r104_spev_MR1, r104_spev_MR2, r104_spev_MR3, r104_spev_MR4, r104_spev_MR5, r104_spev_MR6,  
  r105_spev_MR1, r105_spev_MR2, r105_spev_MR3, r105_spev_MR4, r105_spev_MR5, r105_spev_MR6,  
  r103_dse_MR1, r103_dse_MR2, r103_dse_MR3, r103_dse_MR4, r103_dse_MR5, r103_dse_MR6,  
  r104_dse_MR1, r104_dse_MR2, r104_dse_MR3, r104_dse_MR4, r104_dse_MR5, r104_dse_MR6,  
  r105_dse_MR1, r105_dse_MR2, r105_dse_MR3, r105_dse_MR4, r105_dse_MR5, r105_dse_MR6,  
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       order = c("^`Synesthesia`$",
                                 "^`Aesthetic involvement in nature`$",
                                 "^`Altered states of consciousness \\(a\\)`$",
                                 "^`Imaginative involvement`$",
                                 "^`Sensed presence`$",
                                 "^`Altered states of consciousness \\(b\\)`$"),
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T)

cat(sub_interact_fun(table_s32_subscales), 
    file = "./stargazer_tables/table_s32_subscales.html")
```

```{r}
# htmltools::includeHTML("./stargazer_tables/table_s32_subscales.html")
```

```{r, results = "hide"}
table_s32_subscales_MR1 <- stargazer(r103_spev_MR1, r104_spev_MR1, r105_spev_MR1, 
                                     r103_dse_MR1, r104_dse_MR1, r105_dse_MR1, 
                                     type = "html",
                                     ci = T,
                                     report = c("vcsp"),
                                     digits = 2,
                                     digits.extra = 1000,
                                     omit.table.layout = "n",
                                     order = c("^Synesthesia$",
                                               "^`Aesthetic involvement in nature`$",
                                               "^`Altered states of consciousness \\(a\\)`$",
                                               "^`Imaginative involvement`$",
                                               "^`Sensed presence`$",
                                               "^`Altered states of consciousness \\(b\\)`$"),
                                     # dep.var.labels.include = F,
                                     dep.var.caption = "",
                                     single.row = T)

cat(sub_interact_fun(table_s32_subscales_MR1), 
    file = "./stargazer_tables/table_s32_subscales_MR1.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s32_subscales_MR1.html")
```

```{r, results = "hide"}
table_s32_subscales_MR2 <- stargazer(r103_spev_MR2, r104_spev_MR2, r105_spev_MR2, 
                                     r103_dse_MR2, r104_dse_MR2, r105_dse_MR2, 
                                     type = "html",
                                     ci = T,
                                     report = c("vcsp"),
                                     digits = 2,
                                     digits.extra = 1000,
                                     omit.table.layout = "n",
                                     order = c("^Synesthesia$",
                                               "^`Aesthetic involvement in nature`$",
                                               "^`Altered states of consciousness \\(a\\)`$",
                                               "^`Imaginative involvement`$",
                                               "^`Sensed presence`$",
                                               "^`Altered states of consciousness \\(b\\)`$"),
                                     # dep.var.labels.include = F,
                                     dep.var.caption = "",
                                     single.row = T)

cat(sub_interact_fun(table_s32_subscales_MR2), 
    file = "./stargazer_tables/table_s32_subscales_MR2.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s32_subscales_MR2.html")
```

```{r, results = "hide"}
table_s32_subscales_MR3 <- stargazer(r103_spev_MR3, r104_spev_MR3, r105_spev_MR3, 
                                     r103_dse_MR3, r104_dse_MR3, r105_dse_MR3, 
                                     type = "html",
                                     ci = T,
                                     report = c("vcsp"),
                                     digits = 2,
                                     digits.extra = 1000,
                                     omit.table.layout = "n",
                                     order = c("^Synesthesia$",
                                               "^`Aesthetic involvement in nature`$",
                                               "^`Altered states of consciousness \\(a\\)`$",
                                               "^`Imaginative involvement`$",
                                               "^`Sensed presence`$",
                                               "^`Altered states of consciousness \\(b\\)`$"),
                                     # dep.var.labels.include = F,
                                     dep.var.caption = "",
                                     single.row = T)

cat(sub_interact_fun(table_s32_subscales_MR3), 
    file = "./stargazer_tables/table_s32_subscales_MR3.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s32_subscales_MR3.html")
```

```{r, results = "hide"}
table_s32_subscales_MR4 <- stargazer(r103_spev_MR4, r104_spev_MR4, r105_spev_MR4, 
                                     r103_dse_MR4, r104_dse_MR4, r105_dse_MR4, 
                                     type = "html",
                                     ci = T,
                                     report = c("vcsp"),
                                     digits = 2,
                                     digits.extra = 1000,
                                     omit.table.layout = "n",
                                     order = c("^Synesthesia$",
                                               "^`Aesthetic involvement in nature`$",
                                               "^`Altered states of consciousness \\(a\\)`$",
                                               "^`Imaginative involvement`$",
                                               "^`Sensed presence`$",
                                               "^`Altered states of consciousness \\(b\\)`$"),
                                     # dep.var.labels.include = F,
                                     dep.var.caption = "",
                                     single.row = T)

cat(sub_interact_fun(table_s32_subscales_MR4), 
    file = "./stargazer_tables/table_s32_subscales_MR4.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s32_subscales_MR4.html")
```

```{r, results = "hide"}
table_s32_subscales_MR5 <- stargazer(r103_spev_MR5, r104_spev_MR5, r105_spev_MR5, 
                                     r103_dse_MR5, r104_dse_MR5, r105_dse_MR5, 
                                     type = "html",
                                     ci = T,
                                     report = c("vcsp"),
                                     digits = 2,
                                     digits.extra = 1000,
                                     omit.table.layout = "n",
                                     order = c("^Synesthesia$",
                                               "^`Aesthetic involvement in nature`$",
                                               "^`Altered states of consciousness \\(a\\)`$",
                                               "^`Imaginative involvement`$",
                                               "^`Sensed presence`$",
                                               "^`Altered states of consciousness \\(b\\)`$"),
                                     # dep.var.labels.include = F,
                                     dep.var.caption = "",
                                     single.row = T)

cat(sub_interact_fun(table_s32_subscales_MR5), 
    file = "./stargazer_tables/table_s32_subscales_MR5.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s32_subscales_MR5.html")
```

```{r, results = "hide"}
table_s32_subscales_MR6 <- stargazer(r103_spev_MR6, r104_spev_MR6, r105_spev_MR6, 
                                     r103_dse_MR6, r104_dse_MR6, r105_dse_MR6, 
                                     type = "html",
                                     ci = T,
                                     report = c("vcsp"),
                                     digits = 2,
                                     digits.extra = 1000,
                                     omit.table.layout = "n",
                                     order = c("^Synesthesia$",
                                               "^`Aesthetic involvement in nature`$",
                                               "^`Altered states of consciousness \\(a\\)`$",
                                               "^`Imaginative involvement`$",
                                               "^`Sensed presence`$",
                                               "^`Altered states of consciousness \\(b\\)`$"),
                                     # dep.var.labels.include = F,
                                     dep.var.caption = "",
                                     single.row = T)

cat(sub_interact_fun(table_s32_subscales_MR6), 
    file = "./stargazer_tables/table_s32_subscales_MR6.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s32_subscales_MR6.html")
```

## Study 4

### Reliability

```{r}
# reliability
bind_rows(MR1 = summary(alpha(d_all_abs %>%
                                rownames_to_column("subject_id") %>% 
                                filter(grepl("s4_", subject_id)) %>%
                                column_to_rownames("subject_id") %>%
                                select(d_all_all_scales %>% 
                                         filter(factor == "MR1") %>% 
                                         pull(question)))),
          MR2 = summary(alpha(d_all_abs %>%
                                rownames_to_column("subject_id") %>% 
                                filter(grepl("s4_", subject_id)) %>%
                                column_to_rownames("subject_id") %>%
                                select(d_all_all_scales %>% 
                                         filter(factor == "MR2") %>% 
                                         pull(question)))),
          MR3 = summary(alpha(d_all_abs %>%
                                rownames_to_column("subject_id") %>% 
                                filter(grepl("s4_", subject_id)) %>%
                                column_to_rownames("subject_id") %>%
                                select(d_all_all_scales %>% 
                                         filter(factor == "MR3") %>% 
                                         pull(question)))),
          MR4 = summary(alpha(d_all_abs %>%
                                rownames_to_column("subject_id") %>% 
                                filter(grepl("s4_", subject_id)) %>%
                                column_to_rownames("subject_id") %>%
                                select(d_all_all_scales %>% 
                                         filter(factor == "MR4") %>% 
                                         pull(question)))),
          MR5 = summary(alpha(d_all_abs %>%
                                rownames_to_column("subject_id") %>% 
                                filter(grepl("s4_", subject_id)) %>%
                                column_to_rownames("subject_id") %>%
                                select(d_all_all_scales %>% 
                                         filter(factor == "MR5") %>% 
                                         pull(question)))),
          MR6 = summary(alpha(d_all_abs %>%
                                rownames_to_column("subject_id") %>% 
                                filter(grepl("s4_", subject_id)) %>%
                                column_to_rownames("subject_id") %>%
                                select(d_all_all_scales %>% 
                                         filter(factor == "MR6") %>% 
                                         pull(question)))))

```


### Relationships (analog to Tables S40-S41)

```{r}
d4_abs_subscales <- d_all_abs %>%
  rownames_to_column("subject_id") %>% 
  filter(grepl("s4_", subject_id)) %>%
  gather(question, response, -subject_id) %>%
  left_join(d_all_all_scales %>% distinct(question, factor)) %>% 
  filter(!is.na(factor)) %>%
  mutate(factorlab = recode_factor(factor,
                                   "MR1" = "Synesthesia",
                                   "MR2" = "Aesthetic involvement in nature",
                                   "MR3" = "Altered states of consciousness (a)",
                                   "MR4" = "Imaginative involvement",
                                   "MR5" = "Sensed presence",
                                   "MR6" = "Altered states of consciousness (b)")) %>% 
  group_by(subject_id, factor, factorlab) %>%
  summarise(score = mean(response, na.rm = T)) %>%
  ungroup() %>%
  mutate(subject_id = as.numeric(gsub("s4_", "", subject_id))) %>%
  left_join(d4 %>% distinct(subject_id, country)) %>%
  group_by(country, factor, factorlab) %>%
  mutate(score = scale(score)) %>%
  ungroup() %>%
  select(-country, -factor) %>%
  spread(factorlab, score) %>%
  mutate_all(as.numeric) %>%
  left_join(d4_fortab_long_spirit)
```

### Analog to Table S40

```{r}
r105_spirit_MR1 <- lmer(Score ~ Scale * Synesthesia
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)

r108_spirit_MR1 <- lmer(Score ~ Scale * Country * Synesthesia
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)

r109_spirit_MR1 <- lmer(Score ~ Scale * Country * `Porosity Vignettes` * Synesthesia
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)

r110_spirit_MR1 <- lmer(Score ~ Scale * Country * `Porosity Scale` * Synesthesia
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)

r111_spirit_MR1 <- lmer(Score ~ Scale * Country * `Porosity Vignettes` * Synesthesia
                        + Gender + Age
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)

r112_spirit_MR1 <- lmer(Score ~ Scale * Country * `Porosity Scale` * Synesthesia
                        + Gender + Age
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)
```

```{r}
r105_spirit_MR2 <- lmer(Score ~ Scale * `Aesthetic involvement in nature`
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)

r108_spirit_MR2 <- lmer(Score ~ Scale * Country * `Aesthetic involvement in nature`
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)

r109_spirit_MR2 <- lmer(Score ~ Scale * Country * `Porosity Vignettes` * `Aesthetic involvement in nature`
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)

r110_spirit_MR2 <- lmer(Score ~ Scale * Country * `Porosity Scale` * `Aesthetic involvement in nature`
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)

r111_spirit_MR2 <- lmer(Score ~ Scale * Country * `Porosity Vignettes` * `Aesthetic involvement in nature`
                        + Gender + Age
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)

r112_spirit_MR2 <- lmer(Score ~ Scale * Country * `Porosity Scale` * `Aesthetic involvement in nature`
                        + Gender + Age
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)
```

```{r}
r105_spirit_MR3 <- lmer(Score ~ Scale * `Altered states of consciousness (a)`
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)

r108_spirit_MR3 <- lmer(Score ~ Scale * Country * `Altered states of consciousness (a)`
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)

r109_spirit_MR3 <- lmer(Score ~ Scale * Country * `Porosity Vignettes` * `Altered states of consciousness (a)`
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)

r110_spirit_MR3 <- lmer(Score ~ Scale * Country * `Porosity Scale` * `Altered states of consciousness (a)`
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)

r111_spirit_MR3 <- lmer(Score ~ Scale * Country * `Porosity Vignettes` * `Altered states of consciousness (a)`
                        + Gender + Age
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)

r112_spirit_MR3 <- lmer(Score ~ Scale * Country * `Porosity Scale` * `Altered states of consciousness (a)`
                        + Gender + Age
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)
```

```{r}
r105_spirit_MR4 <- lmer(Score ~ Scale * `Imaginative involvement`
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)

r108_spirit_MR4 <- lmer(Score ~ Scale * Country * `Imaginative involvement`
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)

r109_spirit_MR4 <- lmer(Score ~ Scale * Country * `Porosity Vignettes` * `Imaginative involvement`
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)

r110_spirit_MR4 <- lmer(Score ~ Scale * Country * `Porosity Scale` * `Imaginative involvement`
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)

r111_spirit_MR4 <- lmer(Score ~ Scale * Country * `Porosity Vignettes` * `Imaginative involvement`
                        + Gender + Age
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)

r112_spirit_MR4 <- lmer(Score ~ Scale * Country * `Porosity Scale` * `Imaginative involvement`
                        + Gender + Age
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)
```

```{r}
r105_spirit_MR5 <- lmer(Score ~ Scale * `Sensed presence`
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)

r108_spirit_MR5 <- lmer(Score ~ Scale * Country * `Sensed presence`
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)

r109_spirit_MR5 <- lmer(Score ~ Scale * Country * `Porosity Vignettes` * `Sensed presence`
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)

r110_spirit_MR5 <- lmer(Score ~ Scale * Country * `Porosity Scale` * `Sensed presence`
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)

r111_spirit_MR5 <- lmer(Score ~ Scale * Country * `Porosity Vignettes` * `Sensed presence`
                        + Gender + Age
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)

r112_spirit_MR5 <- lmer(Score ~ Scale * Country * `Porosity Scale` * `Sensed presence`
                        + Gender + Age
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)
```

```{r}
r105_spirit_MR6 <- lmer(Score ~ Scale * `Altered states of consciousness (b)`
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)

r108_spirit_MR6 <- lmer(Score ~ Scale * Country * `Altered states of consciousness (b)`
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)

r109_spirit_MR6 <- lmer(Score ~ Scale * Country * `Porosity Vignettes` * `Altered states of consciousness (b)`
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)

r110_spirit_MR6 <- lmer(Score ~ Scale * Country * `Porosity Scale` * `Altered states of consciousness (b)`
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)

r111_spirit_MR6 <- lmer(Score ~ Scale * Country * `Porosity Vignettes` * `Altered states of consciousness (b)`
                        + Gender + Age
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)

r112_spirit_MR6 <- lmer(Score ~ Scale * Country * `Porosity Scale` * `Altered states of consciousness (b)`
                        + Gender + Age
                        + (1 | subject_id),
                        control = lmerControl(optimizer = "bobyqa"),
                        data = d4_abs_subscales)
```


```{r, results = "hide"}
table_s40s41_subscales_MR1 <- stargazer(r105_spirit_MR1, r108_spirit_MR1, 
                                        r109_spirit_MR1, r110_spirit_MR1,
                                        r111_spirit_MR1, r112_spirit_MR1,
                                        type = "html",
                                        ci = T,
                                        report = c("vcsp"),
                                        digits = 2,
                                        digits.extra = 1000,
                                        omit.table.layout = "n",
                                        order = c("^Synesthesia$",
                                                  "^`Porosity Vignettes`$",
                                                  "^`Porosity Scale`$",
                                                  "^`Porosity Vignettes`:Synesthesia$",
                                                  "^`Porosity Scale`:Synesthesia$"),
                                        # dep.var.labels.include = F,
                                        dep.var.caption = "",
                                        single.row = T) 

cat(sub_interact_fun(table_s40s41_subscales_MR1), 
    file = "./stargazer_tables/table_s40s41_subscales_MR1.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s40s41_subscales_MR1.html")
```

```{r, results = "hide"}
table_s40s41_subscales_MR2 <- stargazer(r105_spirit_MR2, r108_spirit_MR2, 
                                        r109_spirit_MR2, r110_spirit_MR2,
                                        r111_spirit_MR2, r112_spirit_MR2,
                                        type = "html",
                                        ci = T,
                                        report = c("vcsp"),
                                        digits = 2,
                                        digits.extra = 1000,
                                        omit.table.layout = "n",
                                        order = c("^`Aesthetic involvement in nature`$",
                                                  "^`Porosity Vignettes`$",
                                                  "^`Porosity Scale`$",
                                                  "^`Porosity Vignettes`:`Aesthetic involvement in nature`$",
                                                  "^`Porosity Scale`:`Aesthetic involvement in nature`$"),
                                        # dep.var.labels.include = F,
                                        dep.var.caption = "",
                                        single.row = T) 

cat(sub_interact_fun(table_s40s41_subscales_MR2), 
    file = "./stargazer_tables/table_s40s41_subscales_MR2.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s40s41_subscales_MR2.html")
```

```{r, results = "hide"}
table_s40s41_subscales_MR3 <- stargazer(r105_spirit_MR3, r108_spirit_MR3, 
                                        r109_spirit_MR3, r110_spirit_MR3,
                                        r111_spirit_MR3, r112_spirit_MR3,
                                        type = "html",
                                        ci = T,
                                        report = c("vcsp"),
                                        digits = 2,
                                        digits.extra = 1000,
                                        omit.table.layout = "n",
                                        order = c("^`Altered states of consciousness \\(a\\)`$",
                                                  "^`Porosity Vignettes`$",
                                                  "^`Porosity Scale`$",
                                                  "^`Porosity Vignettes`:`Altered states of consciousness \\(a\\)`$",
                                                  "^`Porosity Scale`:`Altered states of consciousness \\(a\\)`$"),
                                        # dep.var.labels.include = F,
                                        dep.var.caption = "",
                                        single.row = T) 

cat(sub_interact_fun(table_s40s41_subscales_MR3), 
    file = "./stargazer_tables/table_s40s41_subscales_MR3.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s40s41_subscales_MR3.html")
```

```{r, results = "hide"}
table_s40s41_subscales_MR4 <- stargazer(r105_spirit_MR4, r108_spirit_MR4, 
                                        r109_spirit_MR4, r110_spirit_MR4,
                                        r111_spirit_MR4, r112_spirit_MR4,
                                        type = "html",
                                        ci = T,
                                        report = c("vcsp"),
                                        digits = 2,
                                        digits.extra = 1000,
                                        omit.table.layout = "n",
                                        order = c("^`Imaginative involvement`$",
                                                  "^`Porosity Vignettes`$",
                                                  "^`Porosity Scale`$",
                                                  "^`Porosity Vignettes`:`Imaginative involvement`$",
                                                  "^`Porosity Scale`:`Imaginative involvement`$"),
                                        # dep.var.labels.include = F,
                                        dep.var.caption = "",
                                        single.row = T) 

cat(sub_interact_fun(table_s40s41_subscales_MR4), 
    file = "./stargazer_tables/table_s40s41_subscales_MR4.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s40s41_subscales_MR4.html")
```

```{r, results = "hide"}
table_s40s41_subscales_MR5 <- stargazer(r105_spirit_MR5, r108_spirit_MR5, 
                                        r109_spirit_MR5, r110_spirit_MR5,
                                        r111_spirit_MR5, r112_spirit_MR5,
                                        type = "html",
                                        ci = T,
                                        report = c("vcsp"),
                                        digits = 2,
                                        digits.extra = 1000,
                                        omit.table.layout = "n",
                                        order = c("^`Sensed presence`$",
                                                  "^`Porosity Vignettes`$",
                                                  "^`Porosity Scale`$",
                                                  "^`Porosity Vignettes`:`Sensed presence`$",
                                                  "^`Porosity Scale`:`Sensed presence`$"),
                                        # dep.var.labels.include = F,
                                        dep.var.caption = "",
                                        single.row = T) 

cat(sub_interact_fun(table_s40s41_subscales_MR5), 
    file = "./stargazer_tables/table_s40s41_subscales_MR5.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s40s41_subscales_MR5.html")
```

```{r, results = "hide"}
table_s40s41_subscales_MR6 <- stargazer(r105_spirit_MR6, r108_spirit_MR6, 
                                        r109_spirit_MR6, r110_spirit_MR6,
                                        r111_spirit_MR6, r112_spirit_MR6,
                                        type = "html",
                                        ci = T,
                                        report = c("vcsp"),
                                        digits = 2,
                                        digits.extra = 1000,
                                        omit.table.layout = "n",
                                        order = c("^`Altered states of consciousness \\(b\\)`$",
                                                  "^`Porosity Vignettes`$",
                                                  "^`Porosity Scale`$",
                                                  "^`Porosity Vignettes`:`Altered states of consciousness \\(b\\)`$",
                                                  "^`Porosity Scale`:`Altered states of consciousness \\(b\\)`$"),
                                        # dep.var.labels.include = F,
                                        dep.var.caption = "",
                                        single.row = T) 

cat(sub_interact_fun(table_s40s41_subscales_MR6), 
    file = "./stargazer_tables/table_s40s41_subscales_MR6.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s40s41_subscales_MR6.html")
```






