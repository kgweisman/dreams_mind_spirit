---
title: "Study 4"
subtitle: "Luhrmann, Weisman, et al."
output: 
  html_notebook:
    toc: true
    toc_float: true
    code_folding: hide
---

In Study 4, college undergraduates completed a survey consisting of nine measures, including two indices of porosity, the Absorption scale, two indices of spiritual experience, two indices of more secular extraordinary experience, and two control measures.

This notebook contains all of the analyses for Study 4, which closely follow our preregistration of this study (link: https://osf.io/kmtc4)

```{r, message = F}
source("../scripts_general/dependencies.R")
source("../scripts_general/custom_funs.R")
source("../scripts_general/var_recode_contrast.R")
source("../scripts_general/data_load.R")
```


# Demographics (Table S17)

```{r}
d4_demo <- d4 %>% select(-contains("score")) %>% 
  mutate(male = ifelse(grepl("male", tolower(subject_gender)) &
                         !grepl("female", tolower(subject_gender)), 1, 0),
         female = ifelse(grepl("female", tolower(subject_gender)), 1, 0),
         subject_age = ifelse(subject_age > 120, NA_real_, subject_age),
         urban = ifelse(subject_urban_rural == "urban", 1, 0),
         subject_religion = case_when( # deal with religion
           subject_religion %in% 
             c("A.O.G.", "Anglican", "AoG", "AOG", "AOG (Assembly of God)",
               "Apostolic Life Ministry", "Assemblies of God", "Assemblies of God (AOG)",
               "Baptism", "Bible Church", "Bible Church of Vanuatu", "catholic",
               "Catholic", "catholicism", "Catholicism", "Catholicism / Christianism",
               "Chirstianity", "Christian", "Christian Mission Center",
               "Christian religion", "Christianianity", "christianity",
               "Christianity", "Church of Christ", "CMC", "CMC Church", "COC",
               "Living Water [Fresh waters]", "Living Wota (Freshwotas)", "Methodist",
               "New Governant Church of Vanuatu", "NTM", "only Christian",
               "Only Christian", "Only Christian!", "Pilow of Five Ministry",
               "Praise & Worship", "Presbyterian", "Roman Catholic", "S.D.A",
               "S.D.A. Youth", "Sabbath", "SDA (Saturday)", "SDA (Seventh Day Adventist)",
               "SDA, Seventh Day Adventist", "Seventh Day Adventist", "Sunday",
               "Sunday worship", "Sunday Worship", 
               "The Church of Jesus Christ of Latter Day Saints",
               "United Methodist Christian") ~ "Christian",
           subject_religion %in% 
             c("Buddhist", "Buddhism") ~ "Buddhist",
           subject_religion %in%
             c("Muslim", "Islam", "Islam / Mohammedanism", "Islam/Mohammedanism",
               "Some Islam habits") ~ "Muslim",
           grepl("agnost", tolower(subject_religion)) |
             grepl("atheis", tolower(subject_religion)) |
             grepl("don't", tolower(subject_religion)) |
             grepl("none", tolower(subject_religion)) |
             subject_religion == "." | is.na(subject_religion) |
             tolower(subject_religion) %in% 
             c("n/a", "no", "no religion", 
               "no religion, finding one", "not really") ~ "Agnostic/Atheist",
           subject_religion %in% c("missing data", "mdata", "NA") |
             is.na(subject_religion) ~ "Missing data",
           TRUE ~ "Other"),
         agnostic_atheist = (subject_religion == "Agnostic/Atheist"),
         buddhist = (subject_religion == "Buddhist"),
         christian = (subject_religion == "Christian"),
         muslim = (subject_religion == "Muslim"),
         other = (subject_religion == "Other"),
         missing = (subject_religion == "Missing data"))
```

```{r}
d4_demo %>%
  group_by(country) %>%
  summarise(n = n(),
            age_range = paste0(min(subject_age, na.rm = T), "-",
                               max(subject_age, na.rm = T)),
            mean_age = mean(subject_age, na.rm = T),
            percent_male = mean(male, na.rm = T),
            percent_female = mean(female, na.rm = T),
            percent_urban = mean(urban, na.rm = T),
            percent_affr = mean(subject_afford, na.rm = T),
            mean_ses = mean(subject_ses, na.rm = T),
            mean_religiosity = mean(subject_religiosity, na.rm = T),
            percent_christian = mean(christian, na.rm = T),
            percent_agnostic_atheist = mean(agnostic_atheist, na.rm = T),
            percent_buddhist = mean(buddhist, na.rm = T),
            percent_muslim = mean(muslim, na.rm = T),
            percent_other = mean(other, na.rm = T),
            percent_missing = mean(missing, na.rm = T)) %>%
  ungroup() %>%
  # mutate_at(vars(starts_with("mean_")), funs(format(round(., 2), nsmall = 2))) %>%
  mutate_at(vars(starts_with("percent_")),
            funs(paste0(round(. * 100), "%"))) %>%
  rename(Country = country, 
         `Age range` = age_range, `Mean age` = mean_age,
         `% male` = percent_male, `% female` = percent_female,
         `% urban` = percent_urban, `% can afford` = percent_affr,
         `Mean SES` = mean_ses, `Mean religiosity` = mean_religiosity,
         `% Christian` = percent_christian, 
         `% Agnostic/Atheist` = percent_agnostic_atheist, 
         `% Buddhist` = percent_buddhist, 
         `% Muslim` = percent_muslim, 
         `% Other` = percent_other,
         `[% Missing data]` = percent_missing) %>%
  mutate(Country = factor(Country, levels = levels_country)) %>%
  arrange(Country) %>%
  select(Country, n, `Age range`, `Mean age`, `% male`, `% female`,
         `Mean religiosity`,
         `% Christian`, `% Buddhist`, `% Muslim`, `% Other`, `% Agnostic/Atheist`,
         `[% Missing data]`,
         `% urban`, `% can afford`, `Mean SES`) %>%
  kable(digits = 2, align = c(rep("l", 2), rep("r", ncol(.) - 2))) %>%
  kable_styling(font_size = 16) # %>%
# collapse_rows(1:2)
```


# Regression analyses (Tables S36-S61)

## Setup

```{r}
# dataframe with variable names optimized for stargazer tables
d4_fortab <- d4 %>%
  mutate_at(vars(ends_with("_score"), subject_age), scale) %>%
  mutate(subject_gender = factor(subject_gender, 
                                 levels = c("female", "male"))) %>%
  rename("Spiritual Events" = "spev_score",
         "Daily Spiritual Experience" = "dse_score",
         "Porosity Vignettes" = "pv_score",
         "Porosity Scale" = "por_score",
         "Absorption" = "abs_score",
         "Hallucinations" = "hall_score",
         "Paranormal" = "para_score",
         "Need for Cognition" = "cog_score",
         "Sense of Control" = "ctl_score",
         "Country" = "country",
         "Gender" = "subject_gender",
         "Age" = "subject_age")
```

```{r}
# set contrasts
contrasts(d4_fortab$Country) <- cbind(": Gh." = c(-1, 1, 0, 0, 0),
                                      ": Th." = c(-1, 0, 1, 0, 0),
                                      ": Ch." = c(-1, 0, 0, 1, 0),
                                      ": Va." = c(-1, 0, 0, 0, 1))
contrasts(d4_fortab$Gender) <- cbind(": male" = c(-1, 1))
```

```{r}
# show contrasts
cat("Country\n"); contrasts(d4_fortab$Country)
cat("Gender\n"); contrasts(d4_fortab$Gender)
```

## Group differences

### Table S36. Study 4, Spiritual Events and Daily Spiritual Experience: group differences

```{r}
r01_spev <- lm(`Spiritual Events` ~ Country,
               data = d4_fortab)
r02_spev <- lm(`Spiritual Events` ~ Country
               + Gender + Age,
               data = d4_fortab)
```

```{r, include = F}
# run manually to check convergence
summary(r01_spev)
summary(r02_spev)
```

```{r}
r01_dse <- lm(`Daily Spiritual Experience` ~ Country,
              data = d4_fortab)
r02_dse <- lm(`Daily Spiritual Experience` ~ Country
              + Gender + Age,
              data = d4_fortab)
```

```{r, include = F}
# run manually to check convergence
summary(r01_dse)
summary(r02_dse)
```

```{r, results = "hide"}
table_s36 <- stargazer(r01_spev, r02_spev, r01_dse, r02_dse, 
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T)

cat(sub_interact_fun(table_s36), 
    file = "./stargazer_tables/table_s36.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s36.html")
```

### Table S37. Study 4, Porosity Vignettes, Porosity Scale, and Absorption: group differences

```{r}
r01_pv <- lm(`Porosity Vignettes` ~ Country,
             data = d4_fortab)
r02_pv <- lm(`Porosity Vignettes` ~ Country
             + Gender + Age,
             data = d4_fortab)
```

```{r, include = F}
# run manually to check convergence
summary(r01_pv)
summary(r02_pv)
```

```{r}
r01_por <- lm(`Porosity Scale` ~ Country,
              data = d4_fortab)
r02_por <- lm(`Porosity Scale` ~ Country
              + Gender + Age,
              data = d4_fortab)
```

```{r, include = F}
# run manually to check convergence
summary(r01_por)
summary(r02_por)
```

```{r}
r01_abs <- lm(`Absorption` ~ Country,
              data = d4_fortab)
r02_abs <- lm(`Absorption` ~ Country
              + Gender + Age,
              data = d4_fortab)
```

```{r, include = F}
# run manually to check convergence
summary(r01_abs)
summary(r02_abs)
```

```{r, results = "hide"}
table_s37 <- stargazer(r01_pv, r02_pv, r01_por, r02_por, r01_abs, r02_abs, 
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T)

cat(sub_interact_fun(table_s37), 
    file = "./stargazer_tables/table_s37.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s37.html")
```

### Table S38. Study 4, Hallucinations and Paranormal: group differences

```{r}
r01_hall <- lm(`Hallucinations` ~ Country,
               data = d4_fortab)
r02_hall <- lm(`Hallucinations` ~ Country
               + Gender + Age,
               data = d4_fortab)
```

```{r, include = F}
# run manually to check convergence
summary(r01_hall)
summary(r02_hall)
```

```{r}
r01_para <- lm(`Paranormal` ~ Country,
               data = d4_fortab)
r02_para <- lm(`Paranormal` ~ Country
               + Gender + Age,
               data = d4_fortab)
```

```{r, include = F}
# run manually to check convergence
summary(r01_para)
summary(r02_para)
```

```{r, results = "hide"}
table_s38 <- stargazer(r01_hall, r02_hall, r01_para, r02_para,
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T)

cat(sub_interact_fun(table_s38), 
    file = "./stargazer_tables/table_s38.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s38.html")
```
### Table S39. Study 4, Need for Cognition and Sense of Control: group differences

```{r}
r01_cog <- lm(`Need for Cognition` ~ Country,
              data = d4_fortab)
r02_cog <- lm(`Need for Cognition` ~ Country
              + Gender + Age,
              data = d4_fortab)
```

```{r, include = F}
# run manually to check convergence
summary(r01_cog)
summary(r02_cog)
```

```{r}
r01_ctl <- lm(`Sense of Control` ~ Country,
              data = d4_fortab)
r02_ctl <- lm(`Sense of Control` ~ Country
              + Gender + Age,
              data = d4_fortab)
```

```{r, include = F}
# run manually to check convergence
summary(r01_ctl)
summary(r02_ctl)
```

```{r, results = "hide"}
table_s39 <- stargazer(r01_cog, r02_cog, r01_ctl, r02_ctl,
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T)

cat(sub_interact_fun(table_s39), 
    file = "./stargazer_tables/table_s39.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s39.html")
```

## Relationships: Spiritual presence events

### Setup

```{r}
# longform dataframe
d4_fortab_long_spirit <- d4_fortab %>% 
  gather(Scale, Score, 
         c(`Spiritual Events`, `Daily Spiritual Experience`)) %>%
  mutate(Scale = factor(Scale))
```

```{r}
# set contrasts
contrasts(d4_fortab_long_spirit$Country) <- cbind(": Gh." = c(-1, 1, 0, 0, 0),
                                                  ": Th." = c(-1, 0, 1, 0, 0),
                                                  ": Ch." = c(-1, 0, 0, 1, 0),
                                                  ": Va." = c(-1, 0, 0, 0, 1))
contrasts(d4_fortab_long_spirit$Gender) <- cbind(": male" = c(-1, 1))
contrasts(d4_fortab_long_spirit$Scale) <- cbind(": Spiritual Events" = c(-1, 1))
```

```{r}
# show contrasts
cat("Country\n"); contrasts(d4_fortab_long_spirit$Country)
cat("Gender\n"); contrasts(d4_fortab_long_spirit$Gender)
cat("Scale\n"); contrasts(d4_fortab_long_spirit$Scale)
```

### Table S40. Study 4, measures of spiritual presence events: relationships with Porosity Vignettes and Absorption (sample as fixed effect)

```{r}
r03_spirit <- lmer(Score ~ Scale * `Porosity Vignettes`
                   + (1 | subject_id),
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)

r04_spirit <- lmer(Score ~ Scale * `Porosity Scale`
                   + (1 | subject_id),
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)

r05_spirit <- lmer(Score ~ Scale * Absorption
                   + (1 | subject_id),
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)

r06_spirit <- lmer(Score ~ Scale * Country * `Porosity Vignettes`
                   + (1 | subject_id),
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)

r07_spirit <- lmer(Score ~ Scale * Country * `Porosity Scale`
                   + (1 | subject_id),
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)

r08_spirit <- lmer(Score ~ Scale * Country * Absorption
                   + (1 | subject_id),
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)

r09_spirit <- lmer(Score ~ Scale * Country * `Porosity Vignettes` * Absorption
                   + (1 | subject_id),
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)

r10_spirit <- lmer(Score ~ Scale * Country * `Porosity Scale` * Absorption
                   + (1 | subject_id),
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)

r11_spirit <- lmer(Score ~ Scale * Country * `Porosity Vignettes` * Absorption
                   + Gender + Age
                   + (1 | subject_id),
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)

r12_spirit <- lmer(Score ~ Scale * Country * `Porosity Scale` * Absorption
                   + Gender + Age
                   + (1 | subject_id),
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)
```

```{r, include = F}
# run manually to check convergence
summary(r03_spirit)
summary(r04_spirit)
summary(r05_spirit)
summary(r06_spirit)
summary(r07_spirit)
summary(r08_spirit)
summary(r09_spirit)
summary(r10_spirit)
summary(r11_spirit)
summary(r12_spirit)
```

```{r, results = "hide"}
table_s40 <- stargazer(r03_spirit, #r04_spirit, 
                       r05_spirit, r06_spirit, #r07_spirit, 
                       r08_spirit, r09_spirit, #r10_spirit,
                       r11_spirit, #r12_spirit, 
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       order = c("^`Porosity Vignettes`$",
                                 "^Absorption$",
                                 "^`Porosity Vignettes`:Absorption$"),
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T) 

cat(sub_interact_fun(table_s40), 
    file = "./stargazer_tables/table_s40.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s40.html")
```

```{r}
rsq_table_fun(list(r03_spirit, #r04_spirit, 
                   r05_spirit, r06_spirit, #r07_spirit, 
                   r08_spirit, r09_spirit, #r10_spirit,
                   r11_spirit #, r12_spirit 
))
```

### Table S41. Study 4, measures of spiritual presence events: relationships with Porosity Scale and Absorption (sample as fixed effect)

```{r, results = "hide"}
table_s41 <- stargazer(#r03_spirit, 
  r04_spirit, r05_spirit, #r06_spirit,
  r07_spirit, r08_spirit, #r09_spirit, 
  r10_spirit, #r11_spirit, 
  r12_spirit, 
  type = "html",
  ci = T,
  report = c("vcsp"),
  digits = 2,
  digits.extra = 1000,
  omit.table.layout = "n",
  order = c("^`Porosity Scale`$",
            "^Absorption$",
            "^`Porosity Scale`:Absorption$"),
  # dep.var.labels.include = F,
  dep.var.caption = "",
  single.row = T) 

cat(sub_interact_fun(table_s41), 
    file = "./stargazer_tables/table_s41.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s41.html")
```

```{r}
rsq_table_fun(list(#r03_spirit, 
  r04_spirit, r05_spirit, #r06_spirit,
  r07_spirit, r08_spirit, #r09_spirit, 
  r10_spirit, #r11_spirit, 
  r12_spirit))
```

### Table S42. Study 4, measures of spiritual presence events: relationships with Porosity Vignettes and Absorption (sample as random effect)

```{r}
r13_spirit <- lmer(Score ~ Scale
                   + (1 | Country/subject_id),
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)

r14_spirit <- lmer(Score ~ Scale * `Porosity Vignettes`
                   + (1 | Country/subject_id),
                   # + (1 + `Porosity Vignettes` | Country), # adding to above, failed to converge
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)

r15_spirit <- lmer(Score ~ Scale * `Porosity Scale`
                   + (1 | Country/subject_id),
                   # + (1 + `Porosity Scale` | Country), # adding to above, perfectly correlated ranfx
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)

r16_spirit <- lmer(Score ~ Scale * Absorption
                   + (1 | Country/subject_id),
                   # + (1 + Absorption | Country), # adding to above, perfectly correlated ranfx
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)

r17_spirit <- lmer(Score ~ Scale * `Porosity Vignettes` * Absorption
                   + (1 | Country/subject_id),
                   # + (1 + `Porosity Vignettes` * Absorption | Country), # adding to above, perfectly correlated ranfx
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)

r18_spirit <- lmer(Score ~ Scale * `Porosity Scale` * Absorption
                   + (1 | Country/subject_id), 
                   # + (1 + `Porosity Scale` * Absorption | Country), # adding to above, perfectly correlated ranfx
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)

r19_spirit <- lmer(Score ~ Scale * `Porosity Vignettes` * Absorption
                   + Gender + Age
                   + (1 | Country/subject_id),
                   # + (1 + `Porosity Vignettes` * Absorption + Gender + Age | Country),
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)

r20_spirit <- lmer(Score ~ Scale * `Porosity Scale` * Absorption
                   + Gender + Age
                   + (1 | Country/subject_id),
                   # + (1 + `Porosity Scale` * Absorption + Gender + Age | Country),
                   control = lmerControl(optimizer = "bobyqa"),
                   data = d4_fortab_long_spirit)
```

```{r, include = F}
# run manually to check convergence
summary(r13_spirit)
summary(r14_spirit)
summary(r15_spirit)
summary(r16_spirit)
summary(r17_spirit)
summary(r18_spirit)
summary(r19_spirit)
summary(r20_spirit)
```

```{r, results = "hide"}
table_s42 <- stargazer(r13_spirit, r14_spirit, #r15_spirit,
                       r16_spirit, r17_spirit, #r18_spirit,
                       r19_spirit, #r20_spirit,
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       order = c("^`Porosity Vignettes`$",
                                 "^Absorption$",
                                 "^`Porosity Vignettes`:Absorption$"),
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T)

cat(sub_interact_fun(table_s42), 
    file = "./stargazer_tables/table_s42.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s42.html")
```

```{r}
rsq_table_fun(list(r13_spirit, r14_spirit, #r15_spirit,
                   r16_spirit, r17_spirit, #r18_spirit,
                   r19_spirit #, r20_spirit
))
```

### Table S43. Study 4, measures of spiritual presence events: relationships with Porosity Scale and Absorption (sample as random effect)

```{r, results = "hide"}
table_s43 <- stargazer(r13_spirit, #r14_spirit, 
                       r15_spirit, r16_spirit, #r17_spirit, 
                       r18_spirit, #r19_spirit, 
                       r20_spirit,
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       order = c("^`Porosity Scale`$",
                                 "^Absorption$",
                                 "^`Porosity Scale`:Absorption$"),
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T)

cat(sub_interact_fun(table_s43), 
    file = "./stargazer_tables/table_s43.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s43.html")
```

```{r}
rsq_table_fun(list(r13_spirit, #r14_spirit, 
                   r15_spirit, r16_spirit, #r17_spirit, 
                   r18_spirit, #r19_spirit 
                   r20_spirit
))
```

### Table S44. Study 4, measures of spiritual presence events: relationships with Porosity Vignettes by country

```{r}
r21_spirit_us <- lmer(Score ~ Scale * `Porosity Vignettes` 
                      + (1 | subject_id),
                      control = lmerControl(optimizer = "bobyqa"),
                      data = d4_fortab_long_spirit %>% filter(Country == "US") %>%
                        mutate_at(vars(Score, `Porosity Vignettes`), ~ scale(.)))

r21_spirit_gh <- lmer(Score ~ Scale * `Porosity Vignettes` 
                      + (1 | subject_id),
                      control = lmerControl(optimizer = "bobyqa"),
                      data = d4_fortab_long_spirit %>% filter(Country == "Ghana") %>%
                        mutate_at(vars(Score, ,`Porosity Vignettes`), ~ scale(.)))

r21_spirit_th <- lmer(Score ~ Scale * `Porosity Vignettes` 
                      + (1 | subject_id),
                      control = lmerControl(optimizer = "bobyqa"),
                      data = d4_fortab_long_spirit %>% filter(Country == "Thailand") %>%
                        mutate_at(vars(Score, `Porosity Vignettes`), ~ scale(.)))

r21_spirit_ch <- lmer(Score ~ Scale * `Porosity Vignettes` 
                      + (1 | subject_id),
                      control = lmerControl(optimizer = "bobyqa"),
                      data = d4_fortab_long_spirit %>% filter(Country == "China") %>%
                        mutate_at(vars(Score, `Porosity Vignettes`), ~ scale(.)))

r21_spirit_vt <- lmer(Score ~ Scale * `Porosity Vignettes` 
                      + (1 | subject_id),
                      control = lmerControl(optimizer = "bobyqa"),
                      data = d4_fortab_long_spirit %>% filter(Country == "Vanuatu") %>%
                        mutate_at(vars(Score, `Porosity Vignettes`), ~ scale(.)))
```

```{r, include = F}
# run manually to check convergence
summary(r21_spirit_us)
summary(r21_spirit_gh)
summary(r21_spirit_th)
summary(r21_spirit_ch)
summary(r21_spirit_vt)
```

```{r, results = "hide"}
table_s44 <- stargazer(r21_spirit_us, r21_spirit_gh, r21_spirit_th, 
                       r21_spirit_ch, r21_spirit_vt, 
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       order = c("^`Porosity Vignettes`$"),
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T)

cat(sub_interact_fun(table_s44), 
    file = "./stargazer_tables/table_s44.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s44.html")
```

```{r}
rsq_table_fun(list(r21_spirit_us, r21_spirit_gh, r21_spirit_th, 
                   r21_spirit_ch, r21_spirit_vt))
```

### Table S45. Study 4, measures of spiritual presence events: relationships with Porosity Scale by country

```{r}
r22_spirit_us <- lmer(Score ~ Scale * `Porosity Scale` 
                      + (1 | subject_id),
                      control = lmerControl(optimizer = "bobyqa"),
                      data = d4_fortab_long_spirit %>% filter(Country == "US") %>%
                        mutate_at(vars(Score, `Porosity Scale`), ~ scale(.)))

r22_spirit_gh <- lmer(Score ~ Scale * `Porosity Scale` 
                      + (1 | subject_id),
                      control = lmerControl(optimizer = "bobyqa"),
                      data = d4_fortab_long_spirit %>% filter(Country == "Ghana") %>%
                        mutate_at(vars(Score, `Porosity Scale`), ~ scale(.)))

r22_spirit_th <- lmer(Score ~ Scale * `Porosity Scale` 
                      + (1 | subject_id),
                      control = lmerControl(optimizer = "bobyqa"),
                      data = d4_fortab_long_spirit %>% filter(Country == "Thailand") %>%
                        mutate_at(vars(Score, `Porosity Scale`), ~ scale(.)))

r22_spirit_ch <- lmer(Score ~ Scale * `Porosity Scale` 
                      + (1 | subject_id),
                      control = lmerControl(optimizer = "bobyqa"),
                      data = d4_fortab_long_spirit %>% filter(Country == "China") %>%
                        mutate_at(vars(Score, `Porosity Scale`), ~ scale(.)))

r22_spirit_vt <- lmer(Score ~ Scale * `Porosity Scale` 
                      + (1 | subject_id),
                      control = lmerControl(optimizer = "bobyqa"),
                      data = d4_fortab_long_spirit %>% filter(Country == "Vanuatu") %>%
                        mutate_at(vars(Score, `Porosity Scale`), ~ scale(.)))
```

```{r, include = F}
# run manually to check convergence
summary(r22_spirit_us)
summary(r22_spirit_gh)
summary(r22_spirit_th)
summary(r22_spirit_ch)
summary(r22_spirit_vt)
```

```{r, results = "hide"}
table_s45 <- stargazer(r22_spirit_us, r22_spirit_gh, r22_spirit_th, 
                       r22_spirit_ch, r22_spirit_vt, 
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       order = c("^`Porosity Scale`$"),
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T)

cat(sub_interact_fun(table_s45), 
    file = "./stargazer_tables/table_s45.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s45.html")
```

```{r}
rsq_table_fun(list(r22_spirit_us, r22_spirit_gh, r22_spirit_th, 
                   r22_spirit_ch, r22_spirit_vt))
```

### Table S46. Study 4, measures of spiritual presence events: relationships with Absorption by country

```{r}
r23_spirit_us <- lmer(Score ~ Scale * `Absorption` 
                      + (1 | subject_id),
                      control = lmerControl(optimizer = "bobyqa"),
                      data = d4_fortab_long_spirit %>% filter(Country == "US") %>%
                        mutate_at(vars(Score, `Absorption`), ~ scale(.)))

r23_spirit_gh <- lmer(Score ~ Scale * `Absorption` 
                      + (1 | subject_id),
                      control = lmerControl(optimizer = "bobyqa"),
                      data = d4_fortab_long_spirit %>% filter(Country == "Ghana") %>%
                        mutate_at(vars(Score, `Absorption`), ~ scale(.)))

r23_spirit_th <- lmer(Score ~ Scale * `Absorption` 
                      + (1 | subject_id),
                      control = lmerControl(optimizer = "bobyqa"),
                      data = d4_fortab_long_spirit %>% filter(Country == "Thailand") %>%
                        mutate_at(vars(Score, `Absorption`), ~ scale(.)))

r23_spirit_ch <- lmer(Score ~ Scale * `Absorption` 
                      + (1 | subject_id),
                      control = lmerControl(optimizer = "bobyqa"),
                      data = d4_fortab_long_spirit %>% filter(Country == "China") %>%
                        mutate_at(vars(Score, `Absorption`), ~ scale(.)))

r23_spirit_vt <- lmer(Score ~ Scale * `Absorption` 
                      + (1 | subject_id),
                      control = lmerControl(optimizer = "bobyqa"),
                      data = d4_fortab_long_spirit %>% filter(Country == "Vanuatu") %>%
                        mutate_at(vars(Score, `Absorption`), ~ scale(.)))
```

```{r, include = F}
# run manually to check convergence
summary(r23_spirit_us)
summary(r23_spirit_gh)
summary(r23_spirit_th)
summary(r23_spirit_ch)
summary(r23_spirit_vt)
```

```{r, results = "hide"}
table_s46 <- stargazer(r23_spirit_us, r23_spirit_gh, r23_spirit_th, 
                       r23_spirit_ch, r23_spirit_vt, 
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       order = c("^Absorption$"),
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T)

cat(sub_interact_fun(table_s46), 
    file = "./stargazer_tables/table_s46.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s46.html")
```

```{r}
rsq_table_fun(list(r23_spirit_us, r23_spirit_gh, r23_spirit_th, 
                   r23_spirit_ch, r23_spirit_vt))
```

## Relationships: Secular anomalous events

### Setup

```{r}
# longform dataframe
d4_fortab_long_secular <- d4_fortab %>% 
  gather(Scale, Score, 
         c(Hallucinations, Paranormal)) %>%
  mutate(Scale = factor(Scale))
```

```{r}
# set contrasts
contrasts(d4_fortab_long_secular$Country) <- cbind(": Gh." = c(-1, 1, 0, 0, 0),
                                                   ": Th." = c(-1, 0, 1, 0, 0),
                                                   ": Ch." = c(-1, 0, 0, 1, 0),
                                                   ": Va." = c(-1, 0, 0, 0, 1))
contrasts(d4_fortab_long_secular$Gender) <- cbind(": male" = c(-1, 1))
contrasts(d4_fortab_long_secular$Scale) <- cbind(": Hallucinations" = c(1, -1))
```

```{r}
# show contrasts
cat("Country\n"); contrasts(d4_fortab_long_secular$Country)
cat("Gender\n"); contrasts(d4_fortab_long_secular$Gender)
cat("Scale\n"); contrasts(d4_fortab_long_secular$Scale)
```

### Table S47. Study 4, measures of secular anomalous events: relationships with Porosity Vignettes and Absorption (sample as fixed effect)

```{r}
r03_secular <- lmer(Score ~ Scale * `Porosity Vignettes`
                    + (1 | subject_id),
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)

r04_secular <- lmer(Score ~ Scale * `Porosity Scale`
                    + (1 | subject_id),
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)

r05_secular <- lmer(Score ~ Scale * Absorption
                    + (1 | subject_id),
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)

r06_secular <- lmer(Score ~ Scale * Country * `Porosity Vignettes`
                    + (1 | subject_id),
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)

r07_secular <- lmer(Score ~ Scale * Country * `Porosity Scale`
                    + (1 | subject_id),
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)

r08_secular <- lmer(Score ~ Scale * Country * Absorption
                    + (1 | subject_id),
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)

r09_secular <- lmer(Score ~ Scale * Country * `Porosity Vignettes` * Absorption
                    + (1 | subject_id),
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)

r10_secular <- lmer(Score ~ Scale * Country * `Porosity Scale` * Absorption
                    + (1 | subject_id),
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)

r11_secular <- lmer(Score ~ Scale * Country * `Porosity Vignettes` * Absorption
                    + Gender + Age
                    + (1 | subject_id),
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)

r12_secular <- lmer(Score ~ Scale * Country * `Porosity Scale` * Absorption
                    + Gender + Age
                    + (1 | subject_id),
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)
```

```{r, include = F}
# run manually to check convergence
summary(r03_secular)
summary(r04_secular)
summary(r05_secular)
summary(r06_secular)
summary(r07_secular)
summary(r08_secular)
summary(r09_secular)
summary(r10_secular)
summary(r11_secular)
summary(r12_secular)
```

```{r, results = "hide"}
table_s47 <- stargazer(r03_secular, #r04_secular, 
                       r05_secular, r06_secular, #r07_secular, 
                       r08_secular, r09_secular, #r10_secular,
                       r11_secular, #r12_secular, 
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       order = c("^`Porosity Vignettes`$",
                                 "^Absorption$",
                                 "^`Porosity Vignettes`:Absorption$"),
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T) 

cat(sub_interact_fun(table_s47), 
    file = "./stargazer_tables/table_s47.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s47.html")
```

```{r}
rsq_table_fun(list(r03_secular, #r04_secular, 
                   r05_secular, r06_secular, #r07_secular, 
                   r08_secular, r09_secular, #r10_secular,
                   r11_secular #, r12_secular 
))
```

### Table S48. Study 4, measures of secular anomalous events: relationships with Porosity Scale and Absorption (sample as fixed effect)

```{r, results = "hide"}
table_s48 <- stargazer(#r03_secular, 
  r04_secular, r05_secular, #r06_secular,
  r07_secular, r08_secular, #r09_secular, 
  r10_secular, #r11_secular, 
  r12_secular, 
  type = "html",
  ci = T,
  report = c("vcsp"),
  digits = 2,
  digits.extra = 1000,
  omit.table.layout = "n",
  order = c("^`Porosity Scale`$",
            "^Absorption$",
            "^`Porosity Scale`:Absorption$"),
  # dep.var.labels.include = F,
  dep.var.caption = "",
  single.row = T) 

cat(sub_interact_fun(table_s48), 
    file = "./stargazer_tables/table_s48.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s48.html")
```

```{r}
rsq_table_fun(list(#r03_secular, 
  r04_secular, r05_secular, #r06_secular,
  r07_secular, r08_secular, #r09_secular, 
  r10_secular, #r11_secular, 
  r12_secular))
```

### Table S49. Study 4, measures of secular anomalous events: relationships with Porosity Vignettes and Absorption (sample as random effect)

```{r}
r13_secular <- lmer(Score ~ Scale
                    + (1 | Country/subject_id),
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)

r14_secular <- lmer(Score ~ Scale * `Porosity Vignettes`
                    + (1 | Country/subject_id),
                    # + (1 + `Porosity Vignettes` | Country), # adding to above, failed to converge
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)

r15_secular <- lmer(Score ~ Scale * `Porosity Scale`
                    + (1 | Country/subject_id),
                    # + (1 + `Porosity Scale` | Country), # adding to above, perfectly correlated ranfx
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)

r16_secular <- lmer(Score ~ Scale * Absorption
                    + (1 | Country/subject_id),
                    # + (1 + Absorption | Country), # adding to above, perfectly correlated ranfx
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)

r17_secular <- lmer(Score ~ Scale * `Porosity Vignettes` * Absorption
                    + (1 | Country/subject_id),
                    # + (1 + `Porosity Vignettes` * Absorption | Country), # adding to above, perfectly correlated ranfx
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)

r18_secular <- lmer(Score ~ Scale * `Porosity Scale` * Absorption
                    + (1 | Country/subject_id), 
                    # + (1 + `Porosity Scale` * Absorption | Country), # adding to above, perfectly correlated ranfx
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)

r19_secular <- lmer(Score ~ Scale * `Porosity Vignettes` * Absorption
                    + Gender + Age
                    + (1 | Country/subject_id),
                    # + (1 + `Porosity Vignettes` * Absorption + Gender + Age | Country),
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)

r20_secular <- lmer(Score ~ Scale * `Porosity Scale` * Absorption
                    + Gender + Age
                    + (1 | Country/subject_id),
                    # + (1 + `Porosity Scale` * Absorption + Gender + Age | Country),
                    control = lmerControl(optimizer = "bobyqa"),
                    data = d4_fortab_long_secular)
```

```{r, include = F}
# run manually to check convergence
summary(r13_secular)
summary(r14_secular)
summary(r15_secular)
summary(r16_secular)
summary(r17_secular)
summary(r18_secular)
summary(r19_secular)
summary(r20_secular)
```

```{r, results = "hide"}
table_s49 <- stargazer(r13_secular, r14_secular, #r15_secular,
                       r16_secular, r17_secular, #r18_secular,
                       r19_secular, #r20_secular,
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       order = c("^`Porosity Vignettes`$",
                                 "^Absorption$",
                                 "^`Porosity Vignettes`:Absorption$"),
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T)

cat(sub_interact_fun(table_s49), 
    file = "./stargazer_tables/table_s49.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s49.html")
```

```{r}
rsq_table_fun(list(r13_secular, r14_secular, #r15_secular,
                   r16_secular, r17_secular, #r18_secular,
                   r19_secular #, r20_secular
))
```

### Table S50. Study 4, measures of secular anomalous events: relationships with Porosity Scale and Absorption (sample as random effect)

```{r, results = "hide"}
table_s50 <- stargazer(r13_secular, #r14_secular, 
                       r15_secular, r16_secular, #r17_secular, 
                       r18_secular, #r19_secular, 
                       r20_secular,
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       order = c("^`Porosity Scale`$",
                                 "^Absorption$",
                                 "^`Porosity Scale`:Absorption$"),
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T)

cat(sub_interact_fun(table_s50), 
    file = "./stargazer_tables/table_s50.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s50.html")
```

```{r}
rsq_table_fun(list(r13_secular, #r14_secular, 
                   r15_secular, r16_secular, #r17_secular, 
                   r18_secular, #r19_secular 
                   r20_secular
))
```

### Table S51. Study 4, measures of secular anomalous events: relationships with Porosity Vignettes by country

```{r}
r21_secular_us <- lmer(Score ~ Scale * `Porosity Vignettes` 
                       + (1 | subject_id),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_fortab_long_secular %>% filter(Country == "US") %>%
                         mutate_at(vars(Score, `Porosity Vignettes`), ~ scale(.)))

r21_secular_gh <- lmer(Score ~ Scale * `Porosity Vignettes` 
                       + (1 | subject_id),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_fortab_long_secular %>% filter(Country == "Ghana") %>%
                         mutate_at(vars(Score, ,`Porosity Vignettes`), ~ scale(.)))

r21_secular_th <- lmer(Score ~ Scale * `Porosity Vignettes` 
                       + (1 | subject_id),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_fortab_long_secular %>% filter(Country == "Thailand") %>%
                         mutate_at(vars(Score, `Porosity Vignettes`), ~ scale(.)))

r21_secular_ch <- lmer(Score ~ Scale * `Porosity Vignettes` 
                       + (1 | subject_id),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_fortab_long_secular %>% filter(Country == "China") %>%
                         mutate_at(vars(Score, `Porosity Vignettes`), ~ scale(.)))

r21_secular_vt <- lmer(Score ~ Scale * `Porosity Vignettes` 
                       + (1 | subject_id),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_fortab_long_secular %>% filter(Country == "Vanuatu") %>%
                         mutate_at(vars(Score, `Porosity Vignettes`), ~ scale(.)))
```

```{r, include = F}
# run manually to check convergence
summary(r21_secular_us)
summary(r21_secular_gh)
summary(r21_secular_th)
summary(r21_secular_ch)
summary(r21_secular_vt)
```

```{r, results = "hide"}
table_s51 <- stargazer(r21_secular_us, r21_secular_gh, r21_secular_th, 
                       r21_secular_ch, r21_secular_vt, 
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       order = c("^`Porosity Vignettes`$"),
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T)

cat(sub_interact_fun(table_s51), 
    file = "./stargazer_tables/table_s51.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s51.html")
```

```{r}
rsq_table_fun(list(r21_secular_us, r21_secular_gh, r21_secular_th, 
                   r21_secular_ch, r21_secular_vt))
```

### Table S52. Study 4, measures of secular anomalous events: relationships with Porosity Scale by country

```{r}
r22_secular_us <- lmer(Score ~ Scale * `Porosity Scale` 
                       + (1 | subject_id),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_fortab_long_secular %>% filter(Country == "US") %>%
                         mutate_at(vars(Score, `Porosity Scale`), ~ scale(.)))

r22_secular_gh <- lmer(Score ~ Scale * `Porosity Scale` 
                       + (1 | subject_id),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_fortab_long_secular %>% filter(Country == "Ghana") %>%
                         mutate_at(vars(Score, `Porosity Scale`), ~ scale(.)))

r22_secular_th <- lmer(Score ~ Scale * `Porosity Scale` 
                       + (1 | subject_id),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_fortab_long_secular %>% filter(Country == "Thailand") %>%
                         mutate_at(vars(Score, `Porosity Scale`), ~ scale(.)))

r22_secular_ch <- lmer(Score ~ Scale * `Porosity Scale` 
                       + (1 | subject_id),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_fortab_long_secular %>% filter(Country == "China") %>%
                         mutate_at(vars(Score, `Porosity Scale`), ~ scale(.)))

r22_secular_vt <- lmer(Score ~ Scale * `Porosity Scale` 
                       + (1 | subject_id),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_fortab_long_secular %>% filter(Country == "Vanuatu") %>%
                         mutate_at(vars(Score, `Porosity Scale`), ~ scale(.)))
```

```{r, include = F}
# run manually to check convergence
summary(r22_secular_us)
summary(r22_secular_gh)
summary(r22_secular_th)
summary(r22_secular_ch)
summary(r22_secular_vt)
```

```{r, results = "hide"}
table_s52 <- stargazer(r22_secular_us, r22_secular_gh, r22_secular_th, 
                       r22_secular_ch, r22_secular_vt, 
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       order = c("^`Porosity Scale`$"),
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T)

cat(sub_interact_fun(table_s52), 
    file = "./stargazer_tables/table_s52.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s52.html")
```

```{r}
rsq_table_fun(list(r22_secular_us, r22_secular_gh, r22_secular_th, 
                   r22_secular_ch, r22_secular_vt))
```

### Table S53. Study 4, measures of secular anomalous events: relationships with Absorption by country

```{r}
r23_secular_us <- lmer(Score ~ Scale * `Absorption` 
                       + (1 | subject_id),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_fortab_long_secular %>% filter(Country == "US") %>%
                         mutate_at(vars(Score, `Absorption`), ~ scale(.)))

r23_secular_gh <- lmer(Score ~ Scale * `Absorption` 
                       + (1 | subject_id),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_fortab_long_secular %>% filter(Country == "Ghana") %>%
                         mutate_at(vars(Score, `Absorption`), ~ scale(.)))

r23_secular_th <- lmer(Score ~ Scale * `Absorption` 
                       + (1 | subject_id),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_fortab_long_secular %>% filter(Country == "Thailand") %>%
                         mutate_at(vars(Score, `Absorption`), ~ scale(.)))

r23_secular_ch <- lmer(Score ~ Scale * `Absorption` 
                       + (1 | subject_id),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_fortab_long_secular %>% filter(Country == "China") %>%
                         mutate_at(vars(Score, `Absorption`), ~ scale(.)))

r23_secular_vt <- lmer(Score ~ Scale * `Absorption` 
                       + (1 | subject_id),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_fortab_long_secular %>% filter(Country == "Vanuatu") %>%
                         mutate_at(vars(Score, `Absorption`), ~ scale(.)))
```

```{r, include = F}
# run manually to check convergence
summary(r23_secular_us)
summary(r23_secular_gh)
summary(r23_secular_th)
summary(r23_secular_ch)
summary(r23_secular_vt)
```

```{r, results = "hide"}
table_s53 <- stargazer(r23_secular_us, r23_secular_gh, r23_secular_th, 
                       r23_secular_ch, r23_secular_vt, 
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       order = c("^Absorption$"),
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T)

cat(sub_interact_fun(table_s53), 
    file = "./stargazer_tables/table_s53.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s53.html")
```

```{r}
rsq_table_fun(list(r23_secular_us, r23_secular_gh, r23_secular_th, 
                   r23_secular_ch, r23_secular_vt))
```

## Relationships: Predictors of interest vs. control measures

### Setup

```{r}
# longform dataframe
d4_fortab_interest <- d4_fortab %>% 
  gather(Predictor, `Predictor Score`, 
         c(`Porosity Vignettes`, `Porosity Scale`, Absorption, 
           `Need for Cognition`, `Sense of Control`)) %>%
  mutate(Predictor = factor(Predictor,
                            levels = c("Porosity Vignettes", "Porosity Scale", 
                                       "Absorption", "Need for Cognition", 
                                       "Sense of Control")))
```

```{r}
# set contrasts
contrasts(d4_fortab_interest$Country) <- cbind(": Gh." = c(-1, 1, 0, 0, 0),
                                               ": Th." = c(-1, 0, 1, 0, 0),
                                               ": Ch." = c(-1, 0, 0, 1, 0),
                                               ": Va." = c(-1, 0, 0, 0, 1))
contrasts(d4_fortab_interest$Predictor) <- cbind(" A" = c(2, 2, 2, -3, -3),
                                                 " B" = c(1, 1, -2, 0, 0),
                                                 " C" = c(-1, 1, 0, 0, 0),
                                                 " D" = c(0, 0, 0, 1, -1)) 
```

```{r}
# show contrasts
cat("Country\n"); contrasts(d4_fortab_interest$Country)
cat("Predictor\n"); contrasts(d4_fortab_interest$Predictor)
```

### Table S54. Study 4, measures of spiritual presence events: relationships with predictors of interest vs. control measures (sample as fixed effect)

```{r}
r24_spev <- lm(`Spiritual Events` ~ Predictor * `Predictor Score`,
               data = d4_fortab_interest)

r25_spev <- lm(`Spiritual Events` ~ Predictor * `Predictor Score` * Country,
               data = d4_fortab_interest)

r26_spev <- lm(`Spiritual Events` ~ Predictor * `Predictor Score` * Country
               + Gender + Age,
               data = d4_fortab_interest)
```

```{r}
r24_dse <- lm(`Daily Spiritual Experience` ~ Predictor * `Predictor Score`,
              data = d4_fortab_interest)

r25_dse <- lm(`Daily Spiritual Experience` ~ Predictor * `Predictor Score` * Country,
              data = d4_fortab_interest)

r26_dse <- lm(`Daily Spiritual Experience` ~ Predictor * `Predictor Score` * Country 
              + Gender + Age,
              data = d4_fortab_interest)
```

```{r, include = F}
# run manually to check convergence
summary(r24_spev)
summary(r25_spev)
summary(r26_spev)
summary(r24_dse)
summary(r25_dse)
summary(r26_dse)
```

```{r, include=F}
table_s54 <- stargazer(r24_spev, r25_spev, r26_spev, r24_dse, r25_dse, r26_dse,
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T) 

cat(sub_interact_fun(table_s54), 
    file = "./stargazer_tables/table_s54.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s54.html")
```

### Table S55. Study 4, measures of spiritual presence events: relationships with predictors of interest vs. control measures (sample as random effect)

```{r}
r27_spev <- lmer(`Spiritual Events` ~ Predictor * `Predictor Score`
                 # + (1 + Predictor * `Predictor Score` | Country), # perfectly correlated ranfx
                 # + (1 + Predictor + `Predictor Score` | Country), # perfectly correlated ranfx
                 + (1 | Country),
                 control = lmerControl(optimizer = "bobyqa"),
                 data = d4_fortab_interest)

r28_spev <- lmer(`Spiritual Events` ~ Predictor * `Predictor Score`
                 + Gender + Age
                 + (1 | Country),
                 control = lmerControl(optimizer = "bobyqa"),
                 data = d4_fortab_interest)

r27_dse <- lmer(`Daily Spiritual Experience` ~ Predictor * `Predictor Score`
                # + (1 + Predictor * `Predictor Score` | Country),
                + (1 | Country),
                control = lmerControl(optimizer = "bobyqa"),
                data = d4_fortab_interest)

r28_dse <- lmer(`Daily Spiritual Experience` ~ Predictor * `Predictor Score`
                + Gender + Age
                + (1 | Country),
                control = lmerControl(optimizer = "bobyqa"),
                data = d4_fortab_interest)
```

```{r, include = F}
# run manually to check convergence
summary(r27_spev)
summary(r28_spev)
summary(r27_dse)
summary(r28_dse)
```

```{r, include=F}
table_s55 <- stargazer(r27_spev, r28_spev, r27_dse, r28_dse, 
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T)

cat(sub_interact_fun(table_s55), 
    file = "./stargazer_tables/table_s55.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s55.html")
```

```{r}
rsq_table_fun(list(r27_spev, r28_spev, r27_dse, r28_dse))
```

### Table S56. Study 4, measures of secular anomalous events: relationships with predictors of interest vs. control measures (sample as fixed effect)

```{r}
r24_hall <- lm(`Hallucinations` ~ Predictor * `Predictor Score`,
               data = d4_fortab_interest)

r25_hall <- lm(`Hallucinations` ~ Predictor * `Predictor Score` * Country,
               data = d4_fortab_interest)

r26_hall <- lm(`Hallucinations` ~ Predictor * `Predictor Score` * Country
               + Gender + Age,
               data = d4_fortab_interest)
```

```{r}
r24_para <- lm(`Paranormal` ~ Predictor * `Predictor Score`,
               data = d4_fortab_interest)

r25_para <- lm(`Paranormal` ~ Predictor * `Predictor Score` * Country,
               data = d4_fortab_interest)

r26_para <- lm(`Paranormal` ~ Predictor * `Predictor Score` * Country 
               + Gender + Age,
               data = d4_fortab_interest)
```

```{r, include = F}
# run manually to check convergence
summary(r24_hall)
summary(r25_hall)
summary(r26_hall)
summary(r24_para)
summary(r25_para)
summary(r26_para)
```

```{r, include=F}
table_s56 <- stargazer(r24_hall, r25_hall, r26_hall, r24_para, r25_para, r26_para,
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T) 

cat(sub_interact_fun(table_s56), 
    file = "./stargazer_tables/table_s56.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s56.html")
```

### Table S57. Study 4, measures of secular anomalous events: relationships with predictors of interest vs. control measures (sample as random effect)

```{r}
r27_hall <- lmer(`Hallucinations` ~ Predictor * `Predictor Score`
                 # + (1 + Predictor * `Predictor Score` | Country), # perfectly correlated ranfx
                 # + (1 + Predictor + `Predictor Score` | Country), # perfectly correlated ranfx
                 + (1 | Country),
                 data = d4_fortab_interest)

r28_hall <- lmer(`Hallucinations` ~ Predictor * `Predictor Score`
                 + Gender + Age
                 + (1 | Country),
                 data = d4_fortab_interest)

r27_para <- lmer(`Paranormal` ~ Predictor * `Predictor Score`
                 # + (1 + Predictor * `Predictor Score` | Country),
                 + (1 | Country),
                 data = d4_fortab_interest)

r28_para <- lmer(`Paranormal` ~ Predictor * `Predictor Score`
                 + Gender + Age
                 + (1 | Country),
                 data = d4_fortab_interest)
```

```{r, include = F}
# run manually to check convergence
summary(r27_hall)
summary(r28_hall)
summary(r27_para)
summary(r28_para)
```

```{r, include=F}
table_s57 <- stargazer(r27_hall, r28_hall, r27_para, r28_para, 
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T)

cat(sub_interact_fun(table_s57), 
    file = "./stargazer_tables/table_s57.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s57.html")
```

```{r}
rsq_table_fun(list(r27_hall, r28_hall, r27_para, r28_para))
```

## Relationships: Predictors of interest vs. control measures, omitting reverse-coded items

### Setup

```{r}
d4_byquestion <- read_csv("./data_by_question/study4_byquestion.csv")
```

```{r}
d4_norev <- d4_byquestion %>% 
  select(p7_ctry, p7_subj, contains("hthk"), contains("wob"), 
         -contains("cat")) %>%
  gather(question, response, -c(p7_ctry, p7_subj)) %>%
  mutate(scale = case_when(grepl("hthk", question) ~ "cog",
                           grepl("wob", question) ~ "ctl",
                           TRUE ~ NA_character_)) %>%
  # omit reverse-coded items from need for cognition (9 of 18 items)
  filter(!question %in% c("p7_hthk_not.fun", "p7_hthk_lil.challeng", 
                          "p7_hthk_avoid.think", "p7_hthk_hrd.hav.to", 
                          "p7_hthk_smal.daily", "p7_hthk_lil.thought", 
                          "p7_hthk_not.exciting", "p7_hthk_mental.effrt", 
                          "p7_hthk_job.done")) %>%
  # omit reverse-coded items from sense of control (4 of 12 items)
  filter(!question %in% c("p7_wob_set.mind_reverse", "p7_wob_find.ways_reverse",
                          "p7_wob_own.hands_reverse", "p7_wob_future.on.me_reverse")) %>%
  group_by(p7_ctry, p7_subj, scale) %>%
  summarise(score = mean(response, na.rm = T),
            scores = scale(score)) %>%
  ungroup() %>%
  spread(scale, score) %>%
  rename("Need for Cognition, no reverse-coding" = "cog",
         "Sense of Control, no reverse-coding" = "ctl",
         "Country" = "p7_ctry",
         "subject_id" = "p7_subj") %>%
  full_join(d4_fortab)
```

```{r}
# longform dataframe
d4_norev_interest <- d4_norev %>% 
  gather(Predictor, `Predictor Score`, 
         c(`Porosity Vignettes`, `Porosity Scale`, Absorption, 
           `Need for Cognition, no reverse-coding`, `Sense of Control, no reverse-coding`)) %>%
  mutate(Country = factor(Country, levels = levels_country),
         Predictor = factor(Predictor,
                            levels = c("Porosity Vignettes", "Porosity Scale", 
                                       "Absorption", 
                                       "Need for Cognition, no reverse-coding", 
                                       "Sense of Control, no reverse-coding")))
```

```{r}
# set contrasts
contrasts(d4_norev_interest$Country) <- cbind(": Gh." = c(-1, 1, 0, 0, 0),
                                              ": Th." = c(-1, 0, 1, 0, 0),
                                              ": Ch." = c(-1, 0, 0, 1, 0),
                                              ": Va." = c(-1, 0, 0, 0, 1))
contrasts(d4_norev_interest$Predictor) <- cbind(" A" = c(2, 2, 2, -3, -3),
                                                " B" = c(1, 1, -2, 0, 0),
                                                " C" = c(-1, 1, 0, 0, 0),
                                                " D" = c(0, 0, 0, 1, -1))
```

```{r}
# show contrasts
contrasts(d4_norev_interest$Country)
contrasts(d4_norev_interest$Predictor)
```

### Table S58. Study 4, measures of spiritual presence events: relationships with predictors of interest vs. control measures, omitting reverse-coded items (sample as fixed effect)

```{r}
r24_norev_spev <- lm(`Spiritual Events` ~ Predictor * `Predictor Score`,
                     data = d4_norev_interest)

r25_norev_spev <- lm(`Spiritual Events` ~ Predictor * `Predictor Score` * Country,
                     data = d4_norev_interest)

r26_norev_spev <- lm(`Spiritual Events` ~ Predictor * `Predictor Score` * Country
                     + Gender + Age,
                     data = d4_norev_interest)
```

```{r}
r24_norev_dse <- lm(`Daily Spiritual Experience` ~ Predictor * `Predictor Score`,
                    data = d4_norev_interest)

r25_norev_dse <- lm(`Daily Spiritual Experience` ~ Predictor * `Predictor Score` * Country,
                    data = d4_norev_interest)

r26_norev_dse <- lm(`Daily Spiritual Experience` ~ Predictor * `Predictor Score` * Country 
                    + Gender + Age,
                    data = d4_norev_interest)
```

```{r, include = F}
# run manually to check convergence
summary(r24_norev_spev)
summary(r25_norev_spev)
summary(r26_norev_spev)
summary(r24_norev_dse)
summary(r25_norev_dse)
summary(r26_norev_dse)
```

```{r, include=F}
table_s58 <- stargazer(r24_norev_spev, r25_norev_spev, r26_norev_spev,
                       r24_norev_dse, r25_norev_dse, r26_norev_dse,
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T) 

cat(sub_interact_fun(table_s58), 
    file = "./stargazer_tables/table_s58.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s58.html")
```

### Table S59. Study 4, measures of spiritual presence events: relationships with predictors of interest vs. control measures, omitting reverse-coded items (sample as random effect). 

```{r}
r27_norev_spev <- lmer(`Spiritual Events` ~ Predictor * `Predictor Score`
                       # + (1 + Predictor * `Predictor Score` | Country), # perfectly correlated ranfx
                       # + (1 + Predictor + `Predictor Score` | Country), # perfectly correlated ranfx
                       + (1 | Country),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_norev_interest)

r28_norev_spev <- lmer(`Spiritual Events` ~ Predictor * `Predictor Score`
                       + Gender + Age
                       + (1 | Country),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_norev_interest)

r27_norev_dse <- lmer(`Daily Spiritual Experience` ~ Predictor * `Predictor Score`
                      # + (1 + Predictor * `Predictor Score` | Country),
                      + (1 | Country),
                       control = lmerControl(optimizer = "bobyqa"),
                      data = d4_norev_interest)

r28_norev_dse <- lmer(`Daily Spiritual Experience` ~ Predictor * `Predictor Score`
                      + Gender + Age
                      + (1 | Country),
                       control = lmerControl(optimizer = "bobyqa"),
                      data = d4_norev_interest)
```

```{r, include = F}
# run manually to check convergence
summary(r27_norev_spev)
summary(r28_norev_spev)
summary(r27_norev_dse)
summary(r28_norev_dse)
```

```{r, include=F}
table_s59 <- stargazer(r27_norev_spev, r28_norev_spev, r27_norev_dse, r28_norev_dse, 
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T)

cat(sub_interact_fun(table_s59), 
    file = "./stargazer_tables/table_s59.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s59.html")
```

```{r}
rsq_table_fun(list(r27_norev_spev, r28_norev_spev, r27_norev_dse, r28_norev_dse))
```

### Table S60. Study 4, measures of secular anomalous events: relationships with predictors of interest vs. control measures, omitting reverse-coded items (sample as fixed effect)

```{r}
r24_norev_hall <- lm(`Hallucinations` ~ Predictor * `Predictor Score`,
                     data = d4_norev_interest)

r25_norev_hall <- lm(`Hallucinations` ~ Predictor * `Predictor Score` * Country,
                     data = d4_norev_interest)

r26_norev_hall <- lm(`Hallucinations` ~ Predictor * `Predictor Score` * Country
                     + Gender + Age,
                     data = d4_norev_interest)
```

```{r}
r24_norev_para <- lm(`Paranormal` ~ Predictor * `Predictor Score`,
                     data = d4_norev_interest)

r25_norev_para <- lm(`Paranormal` ~ Predictor * `Predictor Score` * Country,
                     data = d4_norev_interest)

r26_norev_para <- lm(`Paranormal` ~ Predictor * `Predictor Score` * Country 
                     + Gender + Age,
                     data = d4_norev_interest)
```

```{r, include = F}
# run manually to check convergence
summary(r24_norev_hall)
summary(r25_norev_hall)
summary(r26_norev_hall)
summary(r24_norev_para)
summary(r25_norev_para)
summary(r26_norev_para)
```

```{r, results = "hide"}
table_s60 <- stargazer(r24_norev_hall, r25_norev_hall, r26_norev_hall,
                       r24_norev_para, r25_norev_para, r26_norev_para,
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T) 

cat(sub_interact_fun(table_s60), 
    file = "./stargazer_tables/table_s60.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s60.html")
```

### Table S61. Study 4, measures of secular anomalous events: relationships with predictors of interest vs. control measures, omitting reverse-coded items (sample as random effect)

```{r}
r27_norev_hall <- lmer(`Hallucinations` ~ Predictor * `Predictor Score`
                       # + (1 + Predictor * `Predictor Score` | Country), # perfectly correlated ranfx
                       # + (1 + Predictor + `Predictor Score` | Country), # perfectly correlated ranfx
                       + (1 | Country),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_norev_interest)

r28_norev_hall <- lmer(`Hallucinations` ~ Predictor * `Predictor Score`
                       + Gender + Age
                       + (1 | Country),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_norev_interest)

r27_norev_para <- lmer(`Paranormal` ~ Predictor * `Predictor Score`
                       # + (1 + Predictor * `Predictor Score` | Country),
                       + (1 | Country),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_norev_interest)

r28_norev_para <- lmer(`Paranormal` ~ Predictor * `Predictor Score`
                       + Gender + Age
                       + (1 | Country),
                       control = lmerControl(optimizer = "bobyqa"),
                       data = d4_norev_interest)
```

```{r, include = F}
# run manually to check convergence
summary(r27_norev_hall)
summary(r28_norev_hall)
summary(r27_norev_para)
summary(r28_norev_para)
```

```{r, include=F}
table_s61 <- stargazer(r27_norev_hall, r28_norev_hall, r27_norev_para, r28_norev_para, 
                       type = "html",
                       ci = T,
                       report = c("vcsp"),
                       digits = 2,
                       digits.extra = 1000,
                       omit.table.layout = "n",
                       # dep.var.labels.include = F,
                       dep.var.caption = "",
                       single.row = T)

cat(sub_interact_fun(table_s61), 
    file = "./stargazer_tables/table_s61.html")
```

```{r}
htmltools::includeHTML("./stargazer_tables/table_s61.html")
```

```{r}
rsq_table_fun(list(r27_norev_hall, r28_norev_hall, r27_norev_para, r28_norev_para))
```




